<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Guerry data: Spatial Multivariate Analysis • Guerry</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Guerry data: Spatial Multivariate Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Guerry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/guerry-multivariate.html">Guerry data: Multivariate Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/MultiSpat.html">Guerry data: Spatial Multivariate Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/Guerry/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Guerry data: Spatial Multivariate Analysis</h1>
                        <h4 data-toc-skip class="author">Stéphane
Dray</h4>
            
            <h4 data-toc-skip class="date">2025-01-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/Guerry/blob/HEAD/vignettes/MultiSpat.Rmd" class="external-link"><code>vignettes/MultiSpat.Rmd</code></a></small>
      <div class="d-none name"><code>MultiSpat.Rmd</code></div>
    </div>

    
    
<p>This vignette indicates how to perform the analyses described in
<span class="citation">Dray and Jombart (<a href="#ref-SD966">2011</a>)</span> of data derived from André-Michel
Guerry’s <span class="citation">(<a href="#ref-SD955">1833</a>)</span>
<em>Essai sur la Statistique Morale de la France</em>. It illustrates
some classical methods for analysis of multivariate spatial data that
focus <em>either</em> on the multivariate aspect or on the spatial one,
as well as some more modern methods that attempt to integrate
geographical and multivariate aspects <em>simultaneously</em>.</p>
<div class="section level2">
<h2 id="preliminary-steps">Preliminary steps<a class="anchor" aria-label="anchor" href="#preliminary-steps"></a>
</h2>
<p>Several packages are required to run the different analyses and
should be loaded. The <code>ade4</code> package for multivariate
analysis is supplemented by <code>adegraphics</code> (for associated
graphical methods) and <code>adespatial</code> for multivariate spatial
analysis. For further information on this spatial analysis approach, see
<code><a href="http://adeverse.github.io/adespatial/articles/tutorial.html" class="external-link">vignette(package="adespatial", "tutorial")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://friendly.github.io/Guerry/" class="external-link">Guerry</a></span><span class="op">)</span>       <span class="co"># Guerry's data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span>           <span class="co"># management of spatial data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span>         <span class="co"># multivariate analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">adegraphics</a></span><span class="op">)</span>  <span class="co"># graphical representation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span>        <span class="co"># spatial dependency</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adeverse/adespatial" class="external-link">adespatial</a></span><span class="op">)</span>   <span class="co"># multivariate spatial analysis</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre></div>
<p>Guerry gathered data on crimes, suicide, literacy and other moral
statistics for various départements (i.e., counties) in France. He
provided the first real social data analysis, using graphics and maps to
summarize this georeferenced multivariate dataset. We use the dataset
<code>gfrance85</code> and consider six key quantitative variables
(shown in the table below) for each of the 85 départements of France in
1830 (Corsica, an island and often an outlier, was excluded).</p>
<p>Data are recorded on aligned scales so that <strong>larger
numbers</strong> consistently reflect “morally better”. Thus, four of
the “bad” variables are recorded in the inverse form, as “Population per
…”. With this scaling, it would be expected that all correlations be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\ge 0</annotation></semantics></math>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Crime_pers</code></td>
<td align="left">Population per crime against persons</td>
</tr>
<tr class="even">
<td align="left"><code>Crime_prop</code></td>
<td align="left">Population per crime against property</td>
</tr>
<tr class="odd">
<td align="left"><code>Literacy</code></td>
<td align="left">Percent of military conscripts who can read and
write</td>
</tr>
<tr class="even">
<td align="left"><code>Donations</code></td>
<td align="left">Donations to the poor</td>
</tr>
<tr class="odd">
<td align="left"><code>Infants</code></td>
<td align="left">Population per illegitimate birth</td>
</tr>
<tr class="even">
<td align="left"><code>Suicides</code></td>
<td align="left">Population per suicide</td>
</tr>
</tbody>
</table>
<p>The dataset <code>gfrance85</code> is actually a
<code>SpatialPolygonsDataFrame</code> object created with the
<code>sp</code> package. It contains the polygon boundaries of the map
of France in 1830, as well the variables in the <code>Guerry</code> data
frame. As an ordinary <code>data.frame</code>, it has these
components</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gfrance85</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "dept"            "Region"          "Department"      "Crime_pers"     </span></span>
<span><span class="co">#&gt;  [5] "Crime_prop"      "Literacy"        "Donations"       "Infants"        </span></span>
<span><span class="co">#&gt;  [9] "Suicides"        "MainCity"        "Wealth"          "Commerce"       </span></span>
<span><span class="co">#&gt; [13] "Clergy"          "Crime_parents"   "Infanticide"     "Donation_clergy"</span></span>
<span><span class="co">#&gt; [17] "Lottery"         "Desertion"       "Instruction"     "Prostitutes"    </span></span>
<span><span class="co">#&gt; [21] "Distance"        "Area"            "Pop1831"</span></span></code></pre></div>
<p>To simplify analyses, we extract the components to be used below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gfrance85</span><span class="op">)</span></span>
<span> <span class="va">gdata</span> <span class="op">&lt;-</span> <span class="va">gfrance85</span><span class="op">@</span><span class="va">data</span>                          <span class="co"># the Guerry data.frame</span></span>
<span> <span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Crime_pers"</span>, <span class="st">"Crime_prop"</span>, <span class="st">"Literacy"</span>, <span class="st">"Donations"</span>, <span class="st">"Infants"</span>, <span class="st">"Suicides"</span><span class="op">)</span></span>
<span> <span class="va">df</span>           <span class="op">&lt;-</span> <span class="va">gdata</span><span class="op">[</span>, <span class="va">vars</span><span class="op">]</span>                    <span class="co"># the 6 variables</span></span>
<span> <span class="va">france.map</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">gfrance85</span>, <span class="st">"SpatialPolygons"</span><span class="op">)</span> <span class="co"># the map</span></span>
<span> <span class="va">xy</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">gfrance85</span><span class="op">)</span>           <span class="co"># spatial coordinates</span></span>
<span> <span class="va">dep.names</span>    <span class="op">&lt;-</span> <span class="va">gdata</span><span class="op">[</span>, <span class="st">"Department"</span><span class="op">]</span>            <span class="co"># departement names</span></span>
<span> <span class="va">region.names</span> <span class="op">&lt;-</span> <span class="va">gdata</span><span class="op">[</span>, <span class="st">"Region"</span><span class="op">]</span>                <span class="co"># region names</span></span>
<span> <span class="va">col.region</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">149</span>, <span class="fl">254</span>, <span class="fl">468</span>, <span class="fl">552</span>, <span class="fl">26</span><span class="op">)</span><span class="op">]</span> <span class="co"># colors for region</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="standard-approaches">Standard approaches<a class="anchor" aria-label="anchor" href="#standard-approaches"></a>
</h2>
<p>In this section, we focus on classical approaches that consider
either the multivariate or the spatial aspect of the data.</p>
<div class="section level3">
<h3 id="multivariate-analysis">Multivariate analysis<a class="anchor" aria-label="anchor" href="#multivariate-analysis"></a>
</h3>
<p>Here we consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">p=6</annotation></semantics></math>
variables measured for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>85</mn></mrow><annotation encoding="application/x-tex">n=85</annotation></semantics></math>
individuals (départements of France). As only quantitative variables
have been recorded, principal component analysis <span class="citation">(PCA, <a href="#ref-SD308">Hotelling 1933</a>)</span>
is well adapted. PCA summarizes the data by maximizing simultaneously
the variance of the projection of the individuals onto the principal
axes and the sum of the squared correlations between the principal
component and the variables.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html" class="external-link">dudi.pca</a></span><span class="op">(</span><span class="va">df</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The biplot is simply obtained by</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, plabel.cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-2-1.png" width="336" style="display: block; margin: auto;"></p>
<p>The first two PCA dimensions account for 35.7% and 20% ,respectively,
of the total variance.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca</span><span class="op">$</span><span class="va">eig</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 35.505 20.680 18.335 10.793  8.877  5.810</span></span></code></pre></div>
<p>Correlations between variables and principal components can be
represented on a correlation circle. The first axis is negatively
correlated to literacy and positively correlated to property crime,
suicides and illegitimate births. The second axis is aligned mainly with
personal crime and donations to the poor.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.corcircle.html" class="external-link">s.corcircle</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">co</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/corcircle-1.png" width="336" style="display: block; margin: auto;"></p>
<p>Spatial information can be added on the factorial map representing
the projections of départements on principal axes by coloring according
to colors representing the different regions of France.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.label.html" class="external-link">s.label</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span>, </span>
<span>        ppoint.col <span class="op">=</span> <span class="va">col.region</span><span class="op">[</span><span class="va">region.names</span><span class="op">]</span>, </span>
<span>        plabel.optim <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        plabel.cex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Draw the map, colored by region:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/s.Spatial.html" class="external-link">s.Spatial</a></span><span class="op">(</span><span class="va">france.map</span>, </span>
<span>          col <span class="op">=</span> <span class="va">col.region</span><span class="op">[</span><span class="va">region.names</span><span class="op">]</span>, </span>
<span>          plabel.cex <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.class.html" class="external-link">s.class</a></span><span class="op">(</span><span class="va">xy</span>, </span>
<span>        <span class="va">region.names</span>, </span>
<span>        col <span class="op">=</span> <span class="va">col.region</span>, </span>
<span>        add <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        ellipseSize <span class="op">=</span> <span class="fl">0</span>, starSize <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;"></p>
<p>For the first axis, the North and East are characterized by negative
scores, corresponding to high levels of literacy and high rates of
suicides, crimes against property and illegitimate births. The second
axis mainly contrasts the West (high donations to the the poor and low
levels of crime against persons) to the South.</p>
</div>
<div class="section level3">
<h3 id="spatial-autocorrelation">Spatial autocorrelation<a class="anchor" aria-label="anchor" href="#spatial-autocorrelation"></a>
</h3>
<p>Spatial autocorrelation statistics, such as <span class="citation">Moran (<a href="#ref-SD455">1948</a>)</span>
Coefficient (MC) and <span class="citation">Geary (<a href="#ref-SD223">1954</a>)</span> Ratio, aim to measure and analyze the
degree of dependency among observations in a geographical context <span class="citation">(<a href="#ref-SD577">Cliff and Ord
1973</a>)</span>.</p>
<div class="section level4">
<h4 id="the-spatial-weighting-matrix">The spatial weighting matrix<a class="anchor" aria-label="anchor" href="#the-spatial-weighting-matrix"></a>
</h4>
<p>The first step of spatial autocorrelation analysis is to define a
spatial weighting matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐖</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{W}=[w_{ij}]</annotation></semantics></math>
. In the case of Guerry’s data, we simply defined a binary neighborhood
where two départements are considered as neighbors if they share a
common border. The spatial weighting matrix is then obtained after
row-standardization (<code>style = "W"</code>):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="va">gfrance85</span><span class="op">)</span></span>
<span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">nb</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code></pre></div>
<p>We can represent this neighborhood on the geographical map:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/s.Spatial.html" class="external-link">s.Spatial</a></span><span class="op">(</span><span class="va">france.map</span>, </span>
<span>          nb <span class="op">=</span> <span class="va">nb</span>, </span>
<span>          plabel.cex <span class="op">=</span> <span class="fl">0</span>, </span>
<span>          pSp.border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-7-1.png" width="336" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="morans-coefficient">Moran’s Coefficient<a class="anchor" aria-label="anchor" href="#morans-coefficient"></a>
</h4>
<p>Once the spatial weights have been defined, the spatial
autocorrelation statistics can then be computed. Let us consider the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-by-1
vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐱</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mn>1</mn></msub><mi>⋯</mi><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mtext mathvariant="normal">T</mtext></msup></mrow><annotation encoding="application/x-tex">\mathbf{x}=\left[ {x_1 \cdots x_n } \right]^\textrm{T}</annotation></semantics></math>
containing measurements of a quantitative variable for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
spatial units. The usual formulation for Moran’s coefficient of spatial
autocorrelation <span class="citation">(<a href="#ref-SD577">Cliff and
Ord 1973</a>; <a href="#ref-SD455">Moran 1948</a>)</span> is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>n</mi><msub><mo>∑</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><mrow><msub><mo>∑</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> where </mtext><mspace width="0.333em"></mspace></mrow><msub><mo>∑</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> with </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>≠</mo><mi>j</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq1}
MC(\mathbf{x})=\frac{n\sum\nolimits_{\left( 2 \right)} {w_{ij} (x_i -\bar 
{x})(x_j -\bar {x})} }{\sum\nolimits_{\left( 2 \right)} {w_{ij} } 
\sum\nolimits_{i=1}^n {(x_i -\bar {x})^2} }\mbox{ where 
}\sum\nolimits_{\left( 2 \right)} =\sum\limits_{i=1}^n {\sum\limits_{j=1}^n 
} \mbox{ with }i\ne j.
\end{equation}</annotation></semantics></math></p>
<p>MC can be rewritten using matrix notation:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>n</mi><mrow><msup><mn>𝟏</mn><mtext mathvariant="normal">T</mtext></msup><mrow><mi>𝐖</mi><mn>𝟏</mn></mrow></mrow></mfrac><mfrac><mrow><msup><mi>𝐳</mi><mtext mathvariant="normal">T</mtext></msup><mrow><mi>𝐖</mi><mi>𝐳</mi></mrow></mrow><mrow><msup><mi>𝐳</mi><mtext mathvariant="normal">T</mtext></msup><mi>𝐳</mi></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq2}
MC(\mathbf{x})=\frac{n}{\mathbf{1}^\textrm{T}\mathbf{W1}}\frac{\mathbf{z}^\textrm{T}{\mathbf{Wz}}}{\mathbf{z}^\textrm{T}\mathbf{z}},
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐳</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐈</mi><mi>n</mi></msub><mo>−</mo><msub><mn>𝟏</mn><mi>n</mi></msub><msubsup><mn>𝟏</mn><mi>n</mi><mtext mathvariant="normal">T</mtext></msubsup><mi>/</mi><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>𝐱</mi></mrow><annotation encoding="application/x-tex">\mathbf{z}=\left ( \mathbf{I}_n-\mathbf{1}_n\mathbf{1}_n^\textrm{T} /n \right )\mathbf{x}</annotation></semantics></math>
is the vector of centered values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">z_i=x_i-\bar{x}</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mn>𝟏</mn><mi>n</mi></msub><annotation encoding="application/x-tex">\mathbf{1}_n</annotation></semantics></math>
is a vector of ones (of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>).</p>
<p>The significance of the observed value of MC can be tested by a
Monte-Carlo procedure, in which locations are permuted to obtain a
distribution of MC under the null hypothesis of random distribution. An
observed value of MC that is greater than that expected at random
indicates the clustering of similar values across space (positive
spatial autocorrelation), while a significant negative value of MC
indicates that neighboring values are more dissimilar than expected by
chance (negative spatial autocorrelation).</p>
<p>We computed MC for the Guerry’s dataset. A positive and significant
autocorrelation is identified for each of the six variables. Thus, the
values of literacy are the most covariant in adjacent departments, while
illegitimate births (Infants) covary least.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://adeverse.github.io/adespatial/reference/moran.randtest.html" class="external-link">moran.randtest</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">lw</span><span class="op">)</span></span>
<span><span class="co">#&gt; class: krandtest lightkrandtest </span></span>
<span><span class="co">#&gt; Monte-Carlo tests</span></span>
<span><span class="co">#&gt; Call: moran.randtest(x = df, listw = lw)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of tests:   6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment method for multiple comparisons:   none </span></span>
<span><span class="co">#&gt; Permutation number:   999 </span></span>
<span><span class="co">#&gt;         Test    Obs Std.Obs   Alter Pvalue</span></span>
<span><span class="co">#&gt; 1 Crime_pers 0.4118   6.126 greater  0.001</span></span>
<span><span class="co">#&gt; 2 Crime_prop 0.2636   4.012 greater  0.002</span></span>
<span><span class="co">#&gt; 3   Literacy 0.7176  10.195 greater  0.001</span></span>
<span><span class="co">#&gt; 4  Donations 0.3534   5.146 greater  0.001</span></span>
<span><span class="co">#&gt; 5    Infants 0.2332   3.781 greater  0.002</span></span>
<span><span class="co">#&gt; 6   Suicides 0.4874   7.461 greater  0.001</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="moran-scatterplot">Moran scatterplot<a class="anchor" aria-label="anchor" href="#moran-scatterplot"></a>
</h4>
<p>If the spatial weighting matrix is row-standardized, we can define
the lag vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mo>=</mo><mrow><mi>𝐖</mi><mi>𝐳</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\tilde{z}} = \mathbf{Wz}</annotation></semantics></math>
(i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>z</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\tilde{z}_i = \sum\limits_{j=1}^n{w_{ij}x_j}</annotation></semantics></math>)
composed of the weighted (by the spatial weighting matrix) averages of
the neighboring values. Thus, we have:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>𝐳</mi><mtext mathvariant="normal">T</mtext></msup><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover></mrow><mrow><msup><mi>𝐳</mi><mtext mathvariant="normal">T</mtext></msup><mi>𝐳</mi></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq3}
MC(\mathbf{x})=\frac{\mathbf{z}^\textrm{T}{\mathbf{\tilde{z}}}}{\mathbf{z}^\textrm{T}\mathbf{z}},
\end{equation}</annotation></semantics></math> since in this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>𝟏</mn><mtext mathvariant="normal">T</mtext></msup><mrow><mi>𝐖</mi><mn>𝟏</mn></mrow><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\mathbf{1}^\textrm{T}\mathbf{W1}=n</annotation></semantics></math>.
This shows clearly that MC measures the autocorrelation by giving an
indication of the intensity of the linear association between the vector
of observed values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐳</mi><annotation encoding="application/x-tex">\mathbf{z}</annotation></semantics></math>
and the vector of weighted averages of neighboring values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\mathbf{\tilde{z}}</annotation></semantics></math>.
<span class="citation">Anselin (<a href="#ref-SD566">1996</a>)</span>
proposed to visualize MC in the form of a bivariate scatterplot of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\mathbf{\tilde{z}}</annotation></semantics></math>
against
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐳</mi><annotation encoding="application/x-tex">\mathbf{z}</annotation></semantics></math>.
A linear regression can be added to this <em>Moran scatterplot</em>,
with slope equal to MC.</p>
<p>Considering the Literacy variable of Guerry’s data, the Moran
scatterplot clearly shows strong autocorrelation. It also shows that the
Hautes-Alpes département has a slightly outlying position characterized
by a high value of Literacy compared to its neighbors.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">x.lag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lag.listw.html" class="external-link">lag.listw</a></span><span class="op">(</span><span class="va">lw</span>, <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.plot.html" class="external-link">moran.plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">lw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">x.lag</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">dep.names</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, pos <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="indirect-integration-of-multivariate-and-geographical-aspects">Indirect integration of multivariate and geographical aspects<a class="anchor" aria-label="anchor" href="#indirect-integration-of-multivariate-and-geographical-aspects"></a>
</h3>
<p>The simplest approach considered a two-step procedure where the data
are first summarized with multivariate analysis such as PCA. In a second
step, univariate spatial statistics or mapping techniques are applied to
PCA scores for each axis separately. One can also test for the presence
of spatial autocorrelation for the first few scores of the analysis,
with univariate autocorrelation statistics such as MC. We mapped scores
of the départements for the first two axes of the PCA of Guerry’s data.
Even if PCA maximizes only the variance of these scores, there is also a
clear spatial structure, as the scores are highly autocorrelated. The
map for the first axis corresponds closely to the split between <em>la
France éclairée</em> (North-East characterized by an higher level of
Literacy) and <em>la France obscure</em>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://adeverse.github.io/adespatial/reference/moran.randtest.html" class="external-link">moran.randtest</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span>, <span class="va">lw</span><span class="op">)</span></span>
<span><span class="co">#&gt; class: krandtest lightkrandtest </span></span>
<span><span class="co">#&gt; Monte-Carlo tests</span></span>
<span><span class="co">#&gt; Call: moran.randtest(x = pca$li, listw = lw)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of tests:   3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment method for multiple comparisons:   none </span></span>
<span><span class="co">#&gt; Permutation number:   999 </span></span>
<span><span class="co">#&gt;    Test    Obs Std.Obs   Alter Pvalue</span></span>
<span><span class="co">#&gt; 1 Axis1 0.5847   8.816 greater  0.001</span></span>
<span><span class="co">#&gt; 2 Axis2 0.5614   7.988 greater  0.001</span></span>
<span><span class="co">#&gt; 3 Axis3 0.1703   2.649 greater  0.006</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.value.html" class="external-link">s.value</a></span><span class="op">(</span><span class="va">xy</span>, </span>
<span>        <span class="va">pca</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>        Sp <span class="op">=</span> <span class="va">france.map</span>, </span>
<span>        pSp.border <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>        symbol <span class="op">=</span> <span class="st">"circle"</span>, </span>
<span>        pgrid.draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="spatial-multivariate-analysis">Spatial multivariate analysis<a class="anchor" aria-label="anchor" href="#spatial-multivariate-analysis"></a>
</h2>
<p>Over the last decades, several approaches have been developed to
consider both geographical and multivariate information simultaneously.
The multivariate aspect is usually treated by techniques of
dimensionality reduction similar to PCA. On the other hand, several
alternatives have been proposed to integrate the spatial
information.</p>
<div class="section level3">
<h3 id="spatial-partition">Spatial partition<a class="anchor" aria-label="anchor" href="#spatial-partition"></a>
</h3>
<p>One alternative is to consider a spatial partition of the study area.
In this case, the spatial information is coded as a categorical
variable, and each category corresponds to a region of the whole study
area. For instance, Guerry’s data contained a partition of France into 5
regions.</p>
<p>We used the between-class analysis <span class="citation">(BCA, <a href="#ref-SD148">Dolédec and Chessel 1987</a>)</span>, to investigate
differences between regions. BCA maximizes the variance between
groups.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">bet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/bca.html" class="external-link">bca</a></span><span class="op">(</span><span class="va">pca</span>, <span class="va">region.names</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Here, 28.8 % of the total variance (sum of eigenvalues of PCA)
corresponds to the between-regions variance (sum of the eigenvalues of
BCA).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bet</span><span class="op">$</span><span class="va">ratio</span></span>
<span><span class="co">#&gt; [1] 0.2942</span></span></code></pre></div>
<p>The main graphical outputs are obtained by the generic
<code>plot</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bet</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The barplot of eigenvalues indicates that two axes should be
interpreted. The first two BCA dimensions account for 59 % and 30.2 %,
respectively, of the between-regions variance.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-14-1.png" width="336" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">bet</span><span class="op">$</span><span class="va">eig</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 58.841 30.543  7.078  3.538</span></span></code></pre></div>
<p>The coefficients used to construct the linear combinations of
variables are represented:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.arrow.html" class="external-link">s.arrow</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">c1</span>, plabel.cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-15-1.png" width="336" style="display: block; margin: auto;"></p>
<p>The first axis opposed literacy to property crime, suicides and
illegitimate births. The second axis is mainly aligned with personal
crime and donations to the poor.</p>
<p>Projections of départements on the BCA axes can be represented on the
factorial map:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.label.html" class="external-link">s.label</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">ls</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dep.names</span><span class="op">)</span>, </span>
<span>        ppoint.cex <span class="op">=</span> <span class="fl">0</span>, </span>
<span>        plabel.optim <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        plabel.col <span class="op">=</span> <span class="va">col.region</span><span class="op">[</span><span class="va">region.names</span><span class="op">]</span>, plabel.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.class.html" class="external-link">s.class</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">ls</span>, </span>
<span>        fac <span class="op">=</span> <span class="va">region.names</span>, </span>
<span>        col <span class="op">=</span> <span class="va">col.region</span>, ellipse <span class="op">=</span> <span class="fl">0</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The scores can be mapped to show the spatial aspects:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.value.html" class="external-link">s.value</a></span><span class="op">(</span><span class="va">xy</span>, </span>
<span>        <span class="va">bet</span><span class="op">$</span><span class="va">ls</span>, </span>
<span>        symbol <span class="op">=</span> <span class="st">"circle"</span>, </span>
<span>        Sp <span class="op">=</span> <span class="va">france.map</span>, </span>
<span>        pSp.col <span class="op">=</span> <span class="va">col.region</span><span class="op">[</span><span class="va">region.names</span><span class="op">]</span>, pSp.border <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The results are very close to those obtained by PCA: the first axis
contrasted the North and the East (<em>la France éclairée</em>) to the
other regions while the South is separated from the other regions by the
second axis. The high variability of the region Centre is also
noticeable. In contrast, the South is very homogeneous.</p>
</div>
<div class="section level3">
<h3 id="spatial-explanatory-variables">Spatial explanatory variables<a class="anchor" aria-label="anchor" href="#spatial-explanatory-variables"></a>
</h3>
<!-- deleted @PCAIV - not in references -->
<p>Principal component analysis with respect to the instrumental
variables <span class="citation">(PCAIV, <a href="#ref-SD540">Rao
1964</a>)</span>, and related methods, have been often used in community
ecology to identify spatial relationships. The spatial information is
introduced in the form of spatial predictors and the analysis maximized
the “spatial variance” (i.e., the variance explained by spatial
predictors). Note that BCA can also be considered as a particular case
of PCAIV, where the explanatory variables are dummy variables indicating
group membership.</p>
<div class="section level4">
<h4 id="trend-surface-of-geographic-coordinates">Trend surface of geographic coordinates<a class="anchor" aria-label="anchor" href="#trend-surface-of-geographic-coordinates"></a>
</h4>
<p><span class="citation">Student (<a href="#ref-SD626">1914</a>)</span>
proposed to express observed values in time series as a polynomial
function of time, and mentioned that this could be done for spatial data
as well. <span class="citation">Borcard, Legendre, and Drapeau (<a href="#ref-SD59">1992</a>)</span> extended this approach to the spatial
and multivariate case by introducing polynomial functions of geographic
coordinates as predictors in PCAIV. We call this approach
PCAIV-POLY.</p>
<p>The centroids of départements of France were used to construct a
second-degree orthogonal polynomial.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poly.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://adeverse.github.io/adespatial/reference/orthobasis.poly.html" class="external-link">orthobasis.poly</a></span><span class="op">(</span><span class="va">xy</span>, degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.value.html" class="external-link">s.value</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">poly.xy</span>, Sp <span class="op">=</span> <span class="va">france.map</span>, plegend.drawKey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-18-1.png" width="576" style="display: block; margin: auto;"></p>
<p>PCAIV is then performed using the <code>pcaiv</code> function:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcaiv.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/pcaiv.html" class="external-link">pcaiv</a></span><span class="op">(</span><span class="va">pca</span>, <span class="va">poly.xy</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Here, 32.4 % of the total variance (sum of eigenvalues of PCA) is
explained by the second-degree polynomial (sum of eigenvalues of PCAIV).
The first two dimensions account for 51.4 % and 35.2 %, respectively, of
the explained variance.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 32.59</span></span>
<span><span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">eig</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 51.888 35.392  5.375  4.828  2.517</span></span></code></pre></div>
<p>The outputs of PCAIV-POLY (coefficients of variables, maps of
départements scores, etc.) are very similar to those obtained by BCA.
They can be represented easily by the generic <code>plot</code>
function:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcaiv.xy</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="morans-eigenvector-maps">Moran’s eigenvector maps<a class="anchor" aria-label="anchor" href="#morans-eigenvector-maps"></a>
</h4>
<p>An alternative way to build spatial predictors is by the
diagonalization of the spatial weighting matrix <strong>W</strong>.
Moran’s eigenvector maps <span class="citation">(MEM, <a href="#ref-SD163">Dray, Legendre, and Peres-Neto 2006</a>)</span> are
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math>
eigenvectors of the doubly-centered matrix <strong>W</strong>. They are
orthogonal vectors with a unit norm maximizing MC <span class="citation">(<a href="#ref-SD264">Griffith 1996</a>)</span>. MEM
associated with high positive (or negative) eigenvalues have high
positive (or negative) autocorrelation. MEM associated with eigenvalues
with small absolute values correspond to low spatial autocorrelation,
and are not suitable for defining spatial structures.</p>
<p>We used the spatial weighting matrix defined above to construct MEM.
The first ten MEM, corresponding to the highest levels of spatial
autocorrelation, have been mapped:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mem1</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://adeverse.github.io/adespatial/reference/mem.html" class="external-link">scores.listw</a></span><span class="op">(</span><span class="va">lw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.value.html" class="external-link">s.value</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">mem1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, Sp <span class="op">=</span> <span class="va">france.map</span>, plegend.drawKey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We introduced the first ten MEM as spatial explanatory variables in
PCAIV. We call this approach PCAIV-MEM.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcaiv.mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/pcaiv.html" class="external-link">pcaiv</a></span><span class="op">(</span><span class="va">pca</span>, <span class="va">mem1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Here, 44.1 % of the total variance (sum of eigenvalues of PCA) is
explained by the first ten MEM (sum of eigenvalues of PCAIV). The first
two dimensions account for 54.9 % and 26.3 %, respectively, of the
explained variance.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 44.97</span></span>
<span><span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">eig</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 55.569 26.394  8.682  4.444  3.383  1.528</span></span></code></pre></div>
<p>The outputs of PCAIV-MEM (coefficients of variables, maps of
départements scores, etc.) are very similar to those obtained by BCA.
They can be represented easily by the generic <code>plot</code>
function:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcaiv.mem</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-25-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="spatial-graph-and-weighting-matrix">Spatial graph and weighting matrix<a class="anchor" aria-label="anchor" href="#spatial-graph-and-weighting-matrix"></a>
</h3>
<p>The MEM framework introduced the spatial information into
multivariate analysis through the eigen-decomposition of the spatial
weighting matrix. Usually, we consider only a part of the information
contained in this matrix because only a subset of MEM are used as
regressors in PCAIV. In this section, we focus on multivariate methods
that consider the spatial weighting matrix under its original form.</p>
<p><span class="citation">Wartenberg (<a href="#ref-SD694">1985</a>)</span> was the first to develop a
multivariate analysis based on MC. His work considered only normed and
centered variables (i.e., normed PCA) for the multivariate part and a
binary symmetric connectivity matrix for the spatial aspect. <span class="citation">Dray, Saïd, and Débias (<a href="#ref-SD807">2008</a>)</span> generalized Wartenberg’s method by
introducing a row-standardized spatial weighting matrix in the analysis
of a statistical triplet. This approach is very general and allows us to
define spatially-constrained versions of various methods (corresponding
to different triplets) such as correspondence analysis or multiple
correspondence analysis. MULTISPATI finds coefficients to obtain a
linear combination of variables that maximizes a compromise between the
classical multivariate analysis and a generalized version of Moran’s
coefficient.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/multispati.html" class="external-link">multispati</a></span><span class="op">(</span><span class="va">pca</span>, <span class="va">lw</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The main outputs of MULTISPATI can be represented easily by the
generic <code>plot</code> function:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The barplot of eigenvalues suggests two main spatial structures.
Eigenvalues of MULTISPATI are the product between the variance and the
spatial autocorrelation of the scores, while PCA maximizes only the
variance. The differences between the two methods are computed by the
<code>summary</code> function:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Spatial Analysis</span></span>
<span><span class="co">#&gt; Call: multispati(dudi = pca, listw = lw, scannf = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scores from the initial duality diagram:</span></span>
<span><span class="co">#&gt;       var   cum  ratio  moran</span></span>
<span><span class="co">#&gt; RS1 2.130 2.130 0.3550 0.5847</span></span>
<span><span class="co">#&gt; RS2 1.241 3.371 0.5619 0.5614</span></span>
<span><span class="co">#&gt; RS3 1.100 4.471 0.7452 0.1703</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multispati eigenvalues decomposition:</span></span>
<span><span class="co">#&gt;        eig   var  moran</span></span>
<span><span class="co">#&gt; CS1 1.3356 2.032 0.6572</span></span>
<span><span class="co">#&gt; CS2 0.7194 1.213 0.5933</span></span></code></pre></div>
<p>Hence, there is a loss of variance compared to PCA (2.14 versus 2.017
for axis 1; 1.201 versus 1.177 for axis 2) but a gain of spatial
autocorrelation (0.551 versus 0.637 for axis 1; 0.561 versus 0.59 for
axis 2).</p>
<p>Coefficients of variables allow to interpret the structures:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.arrow.html" class="external-link">s.arrow</a></span><span class="op">(</span><span class="va">ms</span><span class="op">$</span><span class="va">c1</span>, plabel.cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-29-1.png" width="336" style="display: block; margin: auto;"></p>
<p>The first axis opposes literacy to property crime, suicides and
illegitimate births. The second axis is aligned mainly with personal
crime and donations to the poor. The maps of the scores show that the
spatial structures are very close to those identified by PCA. The
similarity of results between PCA and its spatially optimized version
confirm that the main structures of Guerry’s data are spatial.</p>
<p>Spatial autocorrelation can be seen as the link between one variable
and the lagged vector. This interpretation is used to construct the
Moran scatterplot and can be extended to the multivariate case in
MULTISPATI by analyzing the link between scores and lagged scores:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.match.html" class="external-link">s.match</a></span><span class="op">(</span><span class="va">ms</span><span class="op">$</span><span class="va">li</span>, <span class="va">ms</span><span class="op">$</span><span class="va">ls</span>, plabel.cex <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.match.html" class="external-link">s.match</a></span><span class="op">(</span><span class="va">ms</span><span class="op">$</span><span class="va">li</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">41</span>, <span class="fl">27</span><span class="op">)</span>, <span class="op">]</span>, <span class="va">ms</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">41</span>, <span class="fl">27</span><span class="op">)</span>, <span class="op">]</span>, label <span class="op">=</span> <span class="va">dep.names</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, </span>
<span>     <span class="fl">41</span>, <span class="fl">27</span><span class="op">)</span><span class="op">]</span>, plabel.cex <span class="op">=</span> <span class="fl">0.8</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-30-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Each département can be represented on the factorial map by an arrow
(the bottom corresponds to its score, the head corresponds to its lagged
score. A short arrow reveals a local spatial similarity (between one
plot and its neighbors) while a long arrow reveals a spatial
discrepancy. This viewpoint can be interpreted as a multivariate
extension of the local index of spatial association <span class="citation">(<a href="#ref-SD565">Anselin 1995</a>)</span>. For
instance: * Aude has a very small arrow, indicating that this
département is very similar to its neighbors. * Haute-Loire has a long
horizontal arrow which reflects its high values for the variables
Infants (31017), Suicides (163241) and Crime_prop (18043) compared to
the average values over its neighbors (27032.4, 60097.8 and 10540.8 for
these three variables). * Finistère corresponds to an arrow with a long
vertical length which is due to its high values compared to its
neighbors for Donations (23945 versus 12563) and Crime_pers (29872
versus 25962).</p>
<p>The link between the scores and the lagged scores (averages of
neighbors weighted by the spatial connection matrix) can be mapped in
the geographical space. For the first two axes, we have:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.value.html" class="external-link">s.value</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">ms</span><span class="op">$</span><span class="va">li</span>, Sp <span class="op">=</span> <span class="va">france.map</span><span class="op">)</span></span></code></pre></div>
<p><img src="MultiSpat_files/figure-html/unnamed-chunk-31-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>Even if the methods presented are quite different in their
theoretical and practical viewpoints, their applications to Guerry’s
dataset yield very similar results. We provided a quantitative measure
of this similarity by computing Procrustes statistics <span class="citation">(<a href="#ref-SD516">Peres-Neto and Jackson 2001</a>;
<a href="#ref-SD161">Dray, Chessel, and Thioulouse 2003</a>)</span>
between the scores of the départements onto the first two axes for the
different analyses. All the values of the statistic are very high and
significant; this confirms the high concordance between the outputs of
the different methods.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">mat.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCA"</span>, <span class="st">"BCA"</span>, <span class="st">"PCAIV-POLY"</span>, <span class="st">"PCAIV-MEM"</span>, <span class="st">"MULTISPATI"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">mat.names</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">mat.names</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">bet</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ms</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">bet</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ms</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pcaiv.xy</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ms</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/procuste.randtest.html" class="external-link">procuste.randtest</a></span><span class="op">(</span><span class="va">pcaiv.mem</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ms</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">obs</span></span>
<span></span>
<span><span class="va">mat</span></span>
<span><span class="co">#&gt;               PCA    BCA PCAIV-POLY PCAIV-MEM</span></span>
<span><span class="co">#&gt; BCA        0.9858     NA         NA        NA</span></span>
<span><span class="co">#&gt; PCAIV-POLY 0.9762 0.9904         NA        NA</span></span>
<span><span class="co">#&gt; PCAIV-MEM  0.9894 0.9942     0.9954        NA</span></span>
<span><span class="co">#&gt; MULTISPATI 0.9877 0.9952     0.9947    0.9985</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-SD565" class="csl-entry">
Anselin, L. 1995. <span>“Local Indicators of Spatial
Association.”</span> <em>Geographical Analysis</em> 27: 93–115.
</div>
<div id="ref-SD566" class="csl-entry">
———. 1996. <span>“The <span>M</span>oran Scatterplot as an
<span>ESDA</span> Tool to Assess Local Instability in Spatial
Association.”</span> In <em>Spatial Analytical Perspectives on GIS</em>,
edited by M. M. Fischer, H. J. Scholten, and D. Unwin, 111–25. London:
Taylor; Francis.
</div>
<div id="ref-SD59" class="csl-entry">
Borcard, D., P. Legendre, and P. Drapeau. 1992. <span>“Partialling Out
the Spatial Component of Ecological Variation.”</span> <em>Ecology</em>
73: 1045–55.
</div>
<div id="ref-SD577" class="csl-entry">
Cliff, A. D., and J. K. Ord. 1973. <em>Spatial Autocorrelation</em>.
London: Pion.
</div>
<div id="ref-SD148" class="csl-entry">
Dolédec, S., and D. Chessel. 1987. <span>“Rythmes Saisonniers Et
Composantes Stationnelles En Milieu Aquatique <span>I</span>-
<span>D</span>escription d’un Plan d’observations Complet Par Projection
de Variables.”</span> <em>Acta Oecologica - Oecologia Generalis</em> 8
(3): 403–26.
</div>
<div id="ref-SD161" class="csl-entry">
Dray, S., D. Chessel, and J. Thioulouse. 2003. <span>“Procrustean
Co-Inertia Analysis for the Linking of Multivariate Data Sets.”</span>
<em>Ecoscience</em> 10 (1): 110–19.
</div>
<div id="ref-SD966" class="csl-entry">
Dray, S., and T. Jombart. 2011. <span>“Revisiting Guerry’s Data:
Introducing Spatial Constraints in Multivariate Analysis.”</span>
<em>Annals of Applied Statistics</em> 5 (4): 2278–99.
</div>
<div id="ref-SD163" class="csl-entry">
Dray, S., P. Legendre, and P. R. Peres-Neto. 2006. <span>“Spatial
Modeling: A Comprehensive Framework for Principal Coordinate Analysis of
Neighbor Matrices (<span>PCNM</span>).”</span> <em>Ecological
Modelling</em> 196: 483–93.
</div>
<div id="ref-SD807" class="csl-entry">
Dray, S., S. Saïd, and F. Débias. 2008. <span>“Spatial Ordination of
Vegetation Data Using a Generalization of <span>W</span>artenberg’s
Multivariate Spatial Correlation.”</span> <em>Journal of Vegetation
Science</em> 19: 45–56.
</div>
<div id="ref-SD223" class="csl-entry">
Geary, R. C. 1954. <span>“The Contiguity Ratio and Statistical
Mapping.”</span> <em>The Incorporated Statistician</em> 5 (3): 115–45.
</div>
<div id="ref-SD264" class="csl-entry">
Griffith, D. A. 1996. <span>“Spatial Autocorrelation and Eigenfunctions
of the Geographic Weights Matrix Accompanying Geo-Referenced
Data.”</span> <em>Canadian Geographer</em> 40 (4): 351–67.
</div>
<div id="ref-SD955" class="csl-entry">
Guérry, A. M. 1833. <em>Essai Sur La Statistique Morale de La
France</em>. Paris: Crochard.
</div>
<div id="ref-SD308" class="csl-entry">
Hotelling, H. 1933. <span>“Analysis of a Complex of Statistical
Variables into Principal Components.”</span> <em>Journal of Educational
Psychology</em> 24: 417–41.
</div>
<div id="ref-SD455" class="csl-entry">
Moran, P. A. P. 1948. <span>“The Interpretation of Statistical
Maps.”</span> <em>Journal of the Royal Statistical Society Series
B-Methodological</em> 10: 243–51.
</div>
<div id="ref-SD516" class="csl-entry">
Peres-Neto, P. R., and D. A. Jackson. 2001. <span>“How Well Do
Multivariate Data Sets Match? <span>T</span>he Advantages of a
<span>P</span>rocrustean Superimposition Approach over the
<span>M</span>antel Test.”</span> <em>Oecologia</em> 129: 169–78.
</div>
<div id="ref-SD540" class="csl-entry">
Rao, C. R. 1964. <span>“The Use and Interpretation of Principal
Component Analysis in Applied Research.”</span> <em>Sankhya A</em> 26:
329–59.
</div>
<div id="ref-SD626" class="csl-entry">
Student, W. S. 1914. <span>“The Elimination of Spurious Correlation Due
to Position in Time or Space.”</span> <em>Biometrika</em> 10: 179–80.
</div>
<div id="ref-SD694" class="csl-entry">
Wartenberg, D. 1985. <span>“Multivariate Spatial Correlation: A Method
for Exploratory Geographical Analysis.”</span> <em>Geographical
Analysis</em> 17 (4): 263–83.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, Stephane Dray.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
