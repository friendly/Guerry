<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Guerry data: Multivariate Analysis • Guerry</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Guerry data: Multivariate Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Guerry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/guerry-multivariate.html">Guerry data: Multivariate Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/MultiSpat.html">Guerry data: Spatial Multivariate Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/Guerry/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Guerry data: Multivariate Analysis</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly</h4>
            
            <h4 data-toc-skip class="date">2025-01-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/Guerry/blob/HEAD/vignettes/guerry-multivariate.Rmd" class="external-link"><code>vignettes/guerry-multivariate.Rmd</code></a></small>
      <div class="d-none name"><code>guerry-multivariate.Rmd</code></div>
    </div>

    
    
<p>André-Michel Guerry’s <em>Essai sur la Statistique Morale de la
France</em> <span class="citation">(<a href="#ref-Guerry:1833">Guerry
1833</a>)</span> collected data on crimes, suicide, literacy and other
“moral statistics” for various départements in France. He provided the
first real social data analysis, using graphics and maps to summarize
this multivariate dataset. One of his main goals in this ground-breaking
study was to determine if the prevalence of crime in France could be
explained by other social variables.</p>
<p>In 1833, the scatterplot had not yet been invented; the idea of a
correlation or a regression was still 50 years in the future <span class="citation">(<a href="#ref-Galton:1886">Galton 1886</a>)</span>.
Guerry displayed his data in shaded choropleth maps and semi-graphic
tables and argued how these could be seen as implying systematic, lawful
relations among moral variables.</p>
<p>In this analysis, we ignore the spatial context of the départements
and focus on multivariate analyses of the the data set.</p>
<div class="section level2">
<h2 id="load-data-and-packages">Load data and packages<a class="anchor" aria-label="anchor" href="#load-data-and-packages"></a>
</h2>
<p>We will primarily use the following packages, so load them now.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://friendly.github.io/Guerry/" class="external-link">Guerry</a></span><span class="op">)</span>         <span class="co"># Guerry data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>            <span class="co"># better scatterplots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org" class="external-link">effects</a></span><span class="op">)</span>        <span class="co"># Effect Displays for Linear Models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>        <span class="co"># Elegant Data Visualisations Using the Grammar of Graphics</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span>        <span class="co"># better handling of text labels</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>      <span class="co"># combine plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/" class="external-link">heplots</a></span><span class="op">)</span>        <span class="co"># Hypothesis-Error plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/candisc/" class="external-link">candisc</a></span><span class="op">)</span>        <span class="co"># Visualizing Generalized Canonical Discriminant Analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>          <span class="co"># A Grammar of Data Manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>          <span class="co"># Tidy Messy Data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Guerry</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="guerry-data-set">
<code>Guerry</code> data set<a class="anchor" aria-label="anchor" href="#guerry-data-set"></a>
</h3>
<p>Guerry’s (1833) data consisted of six main moral variables shown in
the table below. He wanted all of these to be recorded on aligned scales
so that <strong>larger</strong> numbers consistently reflected
“<strong>morally better</strong>”. Thus, four of the variables are
recorded in the inverse form, as “Population per …”.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Crime_pers</code></td>
<td align="left">Population per crime against persons</td>
</tr>
<tr class="even">
<td align="left"><code>Crime_prop</code></td>
<td align="left">Population per crime against property</td>
</tr>
<tr class="odd">
<td align="left"><code>Literacy</code></td>
<td align="left">Percent of military conscripts who can read and
write</td>
</tr>
<tr class="even">
<td align="left"><code>Donations</code></td>
<td align="left">Donations to the poor</td>
</tr>
<tr class="odd">
<td align="left"><code>Infants</code></td>
<td align="left">Population per illegitimate birth</td>
</tr>
<tr class="even">
<td align="left"><code>Suicides</code></td>
<td align="left">Population per suicide</td>
</tr>
</tbody>
</table>
<p>The <code>Guerry</code> data set also contains:</p>
<ul>
<li>
<code>dept</code> and <code>Department</code>, the French ID numbers
and names for the 86 départements of metropolitan France in 1830,
including Corsica.</li>
<li>
<code>Region</code>: a factor with main levels “N”, “S”, “E”, “W”,
“C”. Corsica is coded as <code>NA</code>.</li>
<li>A collection of 14 other related variables from other sources at the
same time. See <code><a href="../reference/Guerry.html">?Guerry</a></code> for their precise definitions.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Guerry</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "MainCity"        "Wealth"          "Commerce"        "Clergy"         </span></span>
<span><span class="co">#&gt;  [5] "Crime_parents"   "Infanticide"     "Donation_clergy" "Lottery"        </span></span>
<span><span class="co">#&gt;  [9] "Desertion"       "Instruction"     "Prostitutes"     "Distance"       </span></span>
<span><span class="co">#&gt; [13] "Area"            "Pop1831"</span></span></code></pre></div>
<p>Among these, as other aspects of criminal behavior, we see crime
against parents, <code>Infanticide</code> and <code>Prostitutes</code>.
<code>Clergy</code> and <code>Donations_clergy</code> are considered to
be measures of moral rectitude, potentially counteracting crime.</p>
</div>
<div class="section level3">
<h3 id="guerrys-questions">Guerry’s questions<a class="anchor" aria-label="anchor" href="#guerrys-questions"></a>
</h3>
<p>The main questions that concerned Guerry were whether indicators of
crime could be shown to be related to factors which might be considered
to ameliorate crime. Among these, Guerry focused most on
<code>Literacy</code> defined as the number of military conscripts who
could do more than mark an “X” on their enrollment form. A related
variable is <code>Instruction</code>, the rank recorded from Guerry’s
map; as defined, it is inversely related to <code>Literacy</code>.</p>
<dl>
<dt>Other potential explanatory variables are:</dt>
<dd>
<p><code>Donations</code> (a measure of donations to the poor),</p>
</dd>
<dd>
<code>Donation_clergy</code> (a measure of donations to clergy)
</dd>
<dd>
<code>Clergy</code> (the rank of number of Catholic priests in active
service, per population)
</dd>
</dl>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-visualization-methods">Multivariate visualization methods<a class="anchor" aria-label="anchor" href="#multivariate-visualization-methods"></a>
</h2>
<p>Visualization methods for multivariate data take an enormous variety
of forms simply because more than two dimensions of data offer
exponentially increasingly possibilities. It is useful to distinguish
several broad categories:</p>
<ul>
<li><p><strong>data plots</strong> : primarily plot the raw data, often
with annotations to aid interpretation (regression lines and smooths,
data ellipses, marginal distributions)</p></li>
<li><p><strong>model plots</strong> : primarily plot the results of a
fitted model, considering that the fitted model may involve more
variables than can be shown in a static 2D plot. Some examples are:
Added variable plots, effect plots, coefficient plots, …</p></li>
<li><p><strong>diagnostic plots</strong> : indicating potential problems
with the fitted model. These include residual plots, influence plots,
plots for testing homogeneity of variance and so forth.</p></li>
<li><p><strong>dimension reduction plots</strong> : plot representations
of the data into a space of fewer dimensions than the number of
variables in the data set. Simple examples include principal components
analysis (PCA) and the related biplots, and multidimensional scaling
(MDS) methods.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="data-plots">Data plots<a class="anchor" aria-label="anchor" href="#data-plots"></a>
</h2>
<p>Data plots portray the data in a space where the coordinate axes are
the observed variables.</p>
<ul>
<li>1D plots include line plots, histograms and density estimates</li>
<li>2D plots are most often scatterplots, but contour plots or
hex-binned plots are also useful when the sample size is large.</li>
<li>For higher dimensions, biplots, showing the data in principal
components space, together with vectors representing the correlations
among variables, are often the most useful.</li>
</ul>
<!-- ```{r child = "../man/partials/_ggradar.Rmd"} --><!-- ``` --><div class="section level3">
<h3 id="density-plots">Density plots<a class="anchor" aria-label="anchor" href="#density-plots"></a>
</h3>
<p>It is useful to examine the distributions of the variables and
<strong>density</strong> plots are quite informative. I want to do this
for each of the 6 main variables, so I’ll use this trick of tidy data
analysis with <code>ggplot2</code>:</p>
<ol style="list-style-type: decimal">
<li>Reshape the data from wide to long. This gives
<code>guerry_long</code>, where the different variables are in a column
labeled <code>variable</code> and the values are in
<code>value</code>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Guerry"</span>, package<span class="op">=</span><span class="st">"Guerry"</span><span class="op">)</span></span>
<span><span class="va">guerry_long</span> <span class="op">&lt;-</span> <span class="va">Guerry</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dept</span><span class="op">:</span><span class="va">Suicides</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Crime_pers</span><span class="op">:</span><span class="va">Suicides</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"variable"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span><span class="va">guerry_long</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 510 × 5</span></span></span>
<span><span class="co">#&gt;     dept Region Department variable   value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 E      Ain        Crime_pers <span style="text-decoration: underline;">28</span>870</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 E      Ain        Crime_prop <span style="text-decoration: underline;">15</span>890</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 E      Ain        Literacy      37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 E      Ain        Donations   <span style="text-decoration: underline;">5</span>098</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 E      Ain        Infants    <span style="text-decoration: underline;">33</span>120</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 E      Ain        Suicides   <span style="text-decoration: underline;">35</span>039</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     2 N      Aisne      Crime_pers <span style="text-decoration: underline;">26</span>226</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2 N      Aisne      Crime_prop  <span style="text-decoration: underline;">5</span>521</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     2 N      Aisne      Literacy      51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     2 N      Aisne      Donations   <span style="text-decoration: underline;">8</span>901</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 500 more rows</span></span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Plot the density, but make a different subplot by
<code>facet_wrap(~ variable)</code>. These plots all have different
scales for the X and Y (density) values, so it is important to use
<code>scales="FREE"</code>. Moreover, I’m primarily interested in the
<strong>shape</strong> of these distributions, so I suppress the Y axis
tick marks and labels.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">guerry_long</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html" class="external-link">geom_rug</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.ticks.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/guerry-density1-1.png" width="100%"></p>
<p>You can see that all variables are positively skewed,
<code>Donations</code>, <code>Infants</code> and <code>Suicides</code>
particularly so, but not so much as to cause alarm.</p>
<p>It is also of interest to see whether and how these distributions
differ according to <code>Region</code>. This is easy to do, using
<code>aes(... fill=Region)</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col.region</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">149</span>, <span class="fl">254</span>, <span class="fl">468</span>, <span class="fl">552</span>, <span class="fl">26</span><span class="op">)</span><span class="op">]</span> <span class="co"># colors for region</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">guerry_long</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">Region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html" class="external-link">geom_rug</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">col.region</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        axis.ticks.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/guerry-density2-1.png" width="100%">
For some variables, like <code>Infants</code> and <code>Suicides</code>
the differences do not seem particularly large. However, both crime
variables and <code>Literacy</code> show marked differences across
region.</p>
</div>
<div class="section level3">
<h3 id="bivariate-relations">Bivariate relations<a class="anchor" aria-label="anchor" href="#bivariate-relations"></a>
</h3>
<p>Let’s start with plots of crime (<code>Crime_pers</code> and
<code>Crime_prop</code>) in relation to <code>Literacy</code>. A simple
scatterplot is not very informative. All that can be seen is that there
is not much of a relation between personal crime and literacy.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Literacy</span>, y<span class="op">=</span><span class="va">Crime_pers</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Guerry</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/lit-pers-scat0-1.png" width="480"></p>
<p>More useful scatterplots are annotated with additional statistical
summaries to aid interpretation:</p>
<ul>
<li>linear regression line,</li>
<li>smoothed non-parametric (loess) curve, to diagnose potential
non-linear relations,</li>
<li>data ellipses, to highlight the overall trend and variability,</li>
<li>point labels for potentially outlying or influential points.</li>
</ul>
<p>I use <code>ggplot2</code> here. It provides most of these features,
except that to label unusual points, I calculate the Mahalanobis squared
distance of all points from the grand means.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdf</span> <span class="op">&lt;-</span> <span class="va">Guerry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Literacy"</span>, <span class="st">"Crime_pers"</span>, <span class="st">"Department"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">gdf</span><span class="op">$</span><span class="va">dsq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/mahalanobis.html" class="external-link">mahalanobis</a></span><span class="op">(</span><span class="va">gdf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">gdf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">gdf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Literacy</span>, y<span class="op">=</span><span class="va">Crime_pers</span><span class="op">/</span><span class="fl">1000</span>, label<span class="op">=</span><span class="va">Department</span><span class="op">)</span>, data<span class="op">=</span><span class="va">gdf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">stat_ellipse</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">0.68</span>, color<span class="op">=</span><span class="st">"blue"</span>, size<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">stat_ellipse</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">0.95</span>, color<span class="op">=</span><span class="st">"gray"</span>, size<span class="op">=</span><span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"loess"</span>, formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, color<span class="op">=</span><span class="st">"red"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gdf</span><span class="op">[</span><span class="va">gdf</span><span class="op">$</span><span class="va">dsq</span> <span class="op">&gt;</span> <span class="fl">4.6</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/lit-pers-scat-1.png" width="480"></p>
<p>The flat (blue) regression line and the nearly circular data ellipses
show that the correlation is nearly zero; the smoothed (red) curve
indicates that there is no tendency for a nonlinear relation.</p>
<p>Doing the same for crimes against property:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdf</span> <span class="op">&lt;-</span> <span class="va">Guerry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Literacy"</span>, <span class="st">"Crime_prop"</span>, <span class="st">"Department"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">gdf</span><span class="op">$</span><span class="va">dsq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/mahalanobis.html" class="external-link">mahalanobis</a></span><span class="op">(</span><span class="va">gdf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">gdf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">gdf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Literacy</span>, y<span class="op">=</span><span class="va">Crime_prop</span><span class="op">/</span><span class="fl">1000</span>, label<span class="op">=</span><span class="va">Department</span><span class="op">)</span>, data<span class="op">=</span><span class="va">gdf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">stat_ellipse</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">0.68</span>, color<span class="op">=</span><span class="st">"blue"</span>, size<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">stat_ellipse</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">0.95</span>, color<span class="op">=</span><span class="st">"gray"</span>, size<span class="op">=</span><span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"loess"</span>, formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, color<span class="op">=</span><span class="st">"red"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gdf</span><span class="op">[</span><span class="va">gdf</span><span class="op">$</span><span class="va">dsq</span> <span class="op">&gt;</span> <span class="fl">4.6</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/lit-prop-scat-1.png" width="480"></p>
<p>So, somewhat surprisingly, increased literacy is associated with an
increase in property crime (greater population per crime) as opposed to
the situation with personal crime, which seems unrelated to literacy.
Creuse again stands out as an unusual point, one that is likely to be
influential in regression models.</p>
</div>
<div class="section level3">
<h3 id="reconnaisance-plots">Reconnaisance plots<a class="anchor" aria-label="anchor" href="#reconnaisance-plots"></a>
</h3>
<p>Reconnaisance plots attempt to give a bird’s-eye overview of a
multivariate data set. For example, to see the relations among more than
two variables we could turn to a scatterplot matrix or some other
display to show all pairwise bivariate relations.</p>
<p>For these, my preferred package is <code>car</code> <span class="citation">(<a href="#ref-R-car">John Fox, Weisberg, and Price
2024</a>)</span> with the <code>scatterplotMatrix</code> function.
<code>GGally</code> <span class="citation">(<a href="#ref-R-GGally">Schloerke et al. 2024</a>)</span> works within the
the <code>ggplot2</code> framework, but doesn’t have the flexibility I’d
like.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>          <span class="co"># Companion to Applied Regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/scatterplotMatrix.html" class="external-link">scatterplotMatrix</a></span><span class="op">(</span><span class="va">Guerry</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>                  ellipse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>levels<span class="op">=</span><span class="fl">0.68</span><span class="op">)</span>, </span>
<span>                  smooth<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/spm1-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="corrgrams">Corrgrams<a class="anchor" aria-label="anchor" href="#corrgrams"></a>
</h3>
<p>Sometimes, particularly with more variables than this, we want to see
a more schematic overview.<br>
A <em>correlation diagram</em> or “corrgram” <span class="citation">(<a href="#ref-Friendly:02:corrgram">Michael Friendly 2002</a>)</span> is a
graphic display of a correlation matrix, allowing different renderings
of the correlation between each pair of variables: as a shaded box, a
pie symbol, a schematic data ellipse, and other options. This is
implemented in the <code>corrgram</code> package <span class="citation">(<a href="#ref-R-corrgram">Wright 2021</a>)</span>. The
panels in the upper and lower triangles can be rendered differently, as
shown below.</p>
<p><img src="../reference/figures/corrgram-renderings.png"></p>
<p>For the main Guerry variables it looks like this</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/corrgram/" class="external-link">corrgram</a></span><span class="op">)</span>             <span class="co"># Plot a Correlogram</span></span>
<span><span class="fu"><a href="http://kwstat.github.io/corrgram/reference/corrgram.html" class="external-link">corrgram</a></span><span class="op">(</span><span class="va">Guerry</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, upper<span class="op">=</span><span class="va">panel.pie</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/corrgram1-1.png" width="480"></p>
<p>Or, the data in each pairwise tile can be rendered with data ellipses
and smoothed curves to show possible nonlinear relations.</p>
<p>Another feature is that the rows/column variables can be permuted to
put similar variables together, using the <code>order</code> option,
which arranges the variables according to similarity of their
correlations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://kwstat.github.io/corrgram/reference/corrgram.html" class="external-link">corrgram</a></span><span class="op">(</span><span class="va">Guerry</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, </span>
<span>         upper<span class="op">=</span><span class="va">panel.ellipse</span>, </span>
<span>         order<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>         lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/corrgram2-1.png" width="480"></p>
<p>Here, there are a number of pairwise plots that appear markedly
nonlinear. For the main crime variables, the most nonlinear are that of
personal crime vs. donations to the poor, and property crime vs. infants
born out of wedlock and suicides. <code>Literacy</code> stands out here
as having negative relations with all other variables.</p>
<p>An alternative analysis might include:</p>
<ul>
<li>converting the data to ranks.</li>
<li>considering transformations of some of the variables</li>
</ul>
<p>An important feature of corrplots is that they accommodate a large
number of variables. Here I show the correlations among <em>all
numeric</em> variables, using <code>corrplot.mixed</code> from the
<code>corrplot</code> package. This provides for <em>effect
ordering</em> <span class="citation">(<a href="#ref-FriendlyKwan:02:effect">M. Friendly and Kwan 2003</a>)</span>
of the variables in a way that puts the most highly correlated variables
adjacently, making it easier to see their patterns.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span>
<span><span class="va">Guerry.cor</span> <span class="op">&lt;-</span> <span class="va">Guerry</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">-</span><span class="va">dept</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.mixed.html" class="external-link">corrplot.mixed</a></span><span class="op">(</span><span class="va">Guerry.cor</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"AOE"</span>, </span>
<span>  lower <span class="op">=</span> <span class="st">"ellipse"</span>,</span>
<span>  upper <span class="op">=</span> <span class="st">"pie"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"lt"</span>,</span>
<span>  tl.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/corrplot-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="biplots">Biplots<a class="anchor" aria-label="anchor" href="#biplots"></a>
</h3>
<p>Rather than viewing the data in <strong>data space</strong>, a biplot
shows the data in the <strong>reduced-rank PCA space</strong> that
explains most of the variation of the observations. This is essentially
a plot of the observation scores on the first principal component
overlaid with vectors representing the variables projected into PCA
space.</p>
<p>First, we use <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code> to carry out the PCA. We’d like
to visualize the result in relation to <code>Region</code>, so delete
Corsica where <code>Region</code> is missing.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdata</span> <span class="op">&lt;-</span> <span class="va">Guerry</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Region</span>, <span class="va">Crime_pers</span><span class="op">:</span><span class="va">Suicides</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># keep only main variables</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span><span class="op">)</span>                   <span class="co"># delete Corsica (Region==NA)</span></span>
<span></span>
<span><span class="va">guerry.pca</span> <span class="op">&lt;-</span> <span class="va">gdata</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">guerry.pca</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Standard deviations (1, .., p=6):</span></span>
<span><span class="co">#&gt; [1] 1.460 1.114 1.049 0.805 0.730 0.590</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rotation (n x k) = (6 x 6):</span></span>
<span><span class="co">#&gt;                PC1     PC2     PC3    PC4    PC5     PC6</span></span>
<span><span class="co">#&gt; Crime_pers -0.0355 -0.6644 -0.5784 -0.112 -0.026 -0.4578</span></span>
<span><span class="co">#&gt; Crime_prop -0.4993 -0.0137 -0.5082  0.128  0.208  0.6575</span></span>
<span><span class="co">#&gt; Literacy    0.5205  0.1240 -0.1969 -0.120  0.813  0.0115</span></span>
<span><span class="co">#&gt; Donations  -0.0910 -0.6281  0.5250  0.432  0.343  0.1304</span></span>
<span><span class="co">#&gt; Infants    -0.4613 -0.0836  0.3032 -0.784  0.267 -0.0495</span></span>
<span><span class="co">#&gt; Suicides   -0.5073  0.3761 -0.0313  0.394  0.326 -0.5818</span></span></code></pre></div>
<!-- A screeplot shows the proportions of variance accounted for by each component. The results show that only 65% -->
<!-- of the variance is accounted for in two dimensions. -->
<!-- ```{r fig.height=4, fig.width=7} -->
<!-- ggs1 <- ggscreeplot(guerry.pca) + theme_bw() + geom_point(size=4) -->
<!-- ggs2 <- ggscreeplot(guerry.pca, type="cev") + theme_bw() + geom_point(size=4) -->
<!-- ggs1 + ggs2 -->
<!-- ``` -->
<p>In the <code>ggplot2</code> framework, biplots can be produced by the
<code>ggbiplot</code> package <span class="citation">(<a href="#ref-R-ggbiplot">Vu and Friendly 2024</a>)</span>, but this
package is not on CRAN, so cannot be directly used in this vignette.
Instead, the code below was run locally and the result included.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/ggbiplot" class="external-link">ggbiplot</a></span><span class="op">)</span><span class="op">)</span> <span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"vqv/ggbiplot"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/ggbiplot" class="external-link">ggbiplot</a></span><span class="op">)</span> <span class="co"># A ggplot2 based biplot</span></span>
<span><span class="fu"><a href="http://friendly.github.io/ggbiplot/reference/ggbiplot.html" class="external-link">ggbiplot</a></span><span class="op">(</span><span class="va">guerry.pca</span>, groups<span class="op">=</span><span class="va">gdata</span><span class="op">$</span><span class="va">Region</span>, </span>
<span>         ellipse<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>         var.scale <span class="op">=</span> <span class="fl">3</span>, varname.size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"figures/ggbiplot.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fggbiplot.png" width="378"></p>
<p>This is OK, but there are many features of such plots that cannot be
customized (line widths, colors, … ). I prefer those created using the
<code>heplots</code> package.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/rainbow_hcl.html" class="external-link">rainbow_hcl</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/covEllipses.html" class="external-link">covEllipses</a></span><span class="op">(</span><span class="va">guerry.pca</span><span class="op">$</span><span class="va">x</span>, </span>
<span>            group<span class="op">=</span><span class="va">gdata</span><span class="op">$</span><span class="va">Region</span>, </span>
<span>            pooled<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>            fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>            col<span class="op">=</span><span class="va">cols</span>, </span>
<span>            label.pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>            cex<span class="op">=</span><span class="fl">2</span>,</span>
<span>            xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>            xlab <span class="op">=</span> <span class="st">"Dimension 1 (35.7 %)"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Dimension 2 (20.0 %)"</span>,</span>
<span>            cex.lab<span class="op">=</span><span class="fl">1.4</span></span>
<span>            <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">guerry.pca</span><span class="op">$</span><span class="va">x</span>, pch<span class="op">=</span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span><span class="op">[</span><span class="va">Guerry</span><span class="op">$</span><span class="va">Region</span><span class="op">]</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">Guerry</span><span class="op">$</span><span class="va">Region</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">candisc</span><span class="fu">::</span><span class="fu"><a href="https://friendly.github.io/candisc/reference/vectors.html" class="external-link">vectors</a></span><span class="op">(</span><span class="va">guerry.pca</span><span class="op">$</span><span class="va">rotation</span>, scale<span class="op">=</span><span class="fl">5</span>,  </span>
<span>                 col<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">1.4</span>, </span>
<span>                 pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                 xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/biplot2-1.png" width="95%"></p>
<p>An interpretation can be read from both the directions of the
variable arrows and the relative positions of the ellipses representing
the scatter of the component scores for the different regions.</p>
<ul>
<li>The first component is largely aligned positively with
<code>Literacy</code> and negatively with property crime, suicides and
children born out of wedlock (<code>Infants</code>)</li>
<li>The second dimension reflects mainly the correlation of personal
crime and donations to the poor.</li>
<li>The South region is generally lower on PC2, the West, generally
higher.</li>
<li>The North stands out as being higher than the others on PC1; the
West somewhat higher on PC2.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<p>Here we illustrate:</p>
<ul>
<li>Model based plots for linear regression models predicting personal
crime and property crime</li>
<li>Multivariate analysis of variance (MANOVA) and HE plots for the
joint relation of the crime variables to other predictors.</li>
</ul>
<div class="section level3">
<h3 id="predicting-crime-univariate-regression">Predicting crime: Univariate regression<a class="anchor" aria-label="anchor" href="#predicting-crime-univariate-regression"></a>
</h3>
<p>The simplest approach to predicting the crime variables would be to
fit a separate multiple regression to each.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crime.mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Crime_pers</span> <span class="op">~</span>  <span class="va">Region</span> <span class="op">+</span> <span class="va">Literacy</span> <span class="op">+</span> <span class="va">Donations</span> <span class="op">+</span>  <span class="va">Infants</span> <span class="op">+</span> <span class="va">Suicides</span>, data<span class="op">=</span><span class="va">Guerry</span><span class="op">)</span></span>
<span><span class="va">crime.mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Crime_prop</span> <span class="op">~</span>  <span class="va">Region</span> <span class="op">+</span> <span class="va">Literacy</span> <span class="op">+</span> <span class="va">Donations</span> <span class="op">+</span>  <span class="va">Infants</span> <span class="op">+</span> <span class="va">Suicides</span>, data<span class="op">=</span><span class="va">Guerry</span><span class="op">)</span></span></code></pre></div>
<p>Tests for the predictors are best obtained using
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> which gives <strong>partial</strong> (Type II)
tests, adjusting for other predictors, rather than the
<strong>sequential</strong> (Type I) tests provided by
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova()</a></code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">crime.mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: Crime_pers</span></span>
<span><span class="co">#&gt;               Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Region    1305075062  4  8.5222 9.789e-06 ***</span></span>
<span><span class="co">#&gt; Literacy    80862349  1  2.1121    0.1503    </span></span>
<span><span class="co">#&gt; Donations   55264860  1  1.4435    0.2333    </span></span>
<span><span class="co">#&gt; Infants       433571  1  0.0113    0.9155    </span></span>
<span><span class="co">#&gt; Suicides     5885990  1  0.1537    0.6961    </span></span>
<span><span class="co">#&gt; Residuals 2909622973 76                      </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">crime.mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: Crime_prop</span></span>
<span><span class="co">#&gt;              Sum Sq Df F value   Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Region     58042604  4  2.2182 0.074873 .  </span></span>
<span><span class="co">#&gt; Literacy   13063224  1  1.9969 0.161704    </span></span>
<span><span class="co">#&gt; Donations   8093826  1  1.2373 0.269507    </span></span>
<span><span class="co">#&gt; Infants     7058522  1  1.0790 0.302216    </span></span>
<span><span class="co">#&gt; Suicides   79203021  1 12.1073 0.000835 ***</span></span>
<span><span class="co">#&gt; Residuals 497174277 76                     </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>These are somewhat disappointing if you look only at the significance
stars: Only <code>Region</code> is significant for personal crime and
only <code>Suicides</code> for property crime. There is no evidence for
the argument, supported by the liberal hygenicists of Guerry’s time,
that increased <code>Literacy</code> would reduce crime.</p>
<p>For such models, we can understand the nature of the predicted
effects using the <code>effects</code> package. The (marginal) effect
for a given term gives the predicted values, averaging over all other
terms in the model.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/predictorEffects.html" class="external-link">predictorEffects</a></span><span class="op">(</span><span class="va">crime.mod1</span>, <span class="op">~</span> <span class="va">Region</span> <span class="op">+</span> <span class="va">Literacy</span> <span class="op">+</span> <span class="va">Infants</span> <span class="op">+</span> <span class="va">Suicides</span><span class="op">)</span>, </span>
<span>     lwd<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fmra-effect1.png" width="425"></p>
<p>Doing the same for property crime, we get:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/predictorEffects.html" class="external-link">predictorEffects</a></span><span class="op">(</span><span class="va">crime.mod2</span>, <span class="op">~</span> <span class="va">Region</span> <span class="op">+</span> <span class="va">Literacy</span> <span class="op">+</span> <span class="va">Infants</span> <span class="op">+</span> <span class="va">Suicides</span><span class="op">)</span>, </span>
<span>     lwd<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fmra-effect2.png" width="425"></p>
</div>
<div class="section level3">
<h3 id="predicting-crime-multivariate-regression">Predicting crime: Multivariate regression<a class="anchor" aria-label="anchor" href="#predicting-crime-multivariate-regression"></a>
</h3>
<p>The two regression models can be fit together in a multivariate
regression for both crime variables jointly.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crime.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Crime_pers</span>, <span class="va">Crime_prop</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                <span class="va">Region</span> <span class="op">+</span> <span class="va">Literacy</span> <span class="op">+</span> <span class="va">Donations</span> <span class="op">+</span>  <span class="va">Infants</span> <span class="op">+</span> <span class="va">Suicides</span>, data<span class="op">=</span><span class="va">Guerry</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">crime.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;           Df test stat approx F num Df den Df    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Region     4   0.41897   5.0349      8    152 1.472e-05 ***</span></span>
<span><span class="co">#&gt; Literacy   1   0.03657   1.4234      2     75 0.2473351    </span></span>
<span><span class="co">#&gt; Donations  1   0.02421   0.9304      2     75 0.3989076    </span></span>
<span><span class="co">#&gt; Infants    1   0.01575   0.5999      2     75 0.5514648    </span></span>
<span><span class="co">#&gt; Suicides   1   0.17728   8.0804      2     75 0.0006638 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>As a quick check on the assumption that the residuals are bivariate
normally distributed and a check for outliers, a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
Q-Q plot graphs the squared Mahalanobis distances of the residuals
against the corresponding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mn>2</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi^2_2</annotation></semantics></math>
quantiles these would have in a bivariate normal distribution. The data
for Creuse stands out as a potential outlier.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Guerry</span><span class="op">$</span><span class="va">dept</span>,<span class="st">":"</span>, <span class="va">Guerry</span><span class="op">$</span><span class="va">Department</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/cqplot.html" class="external-link">cqplot</a></span><span class="op">(</span><span class="va">crime.mod</span>, id.n<span class="op">=</span><span class="fl">4</span>, labels<span class="op">=</span><span class="va">labels</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/cqplot-1.png" width="480"></p>
<div class="section level4">
<h4 id="he-plots">HE plots<a class="anchor" aria-label="anchor" href="#he-plots"></a>
</h4>
<p>Hypothesis-Error (HE) plots <span class="citation">(<a href="#ref-Friendly:2007:heplots">Michael Friendly 2007</a>; <a href="#ref-FoxFriendlyMonette:09:compstat">J. Fox, Friendly, and Monette
2009</a>; <a href="#ref-heplots">Michael Friendly, Fox, and Georges
Monette 2022</a>)</span> provide a convenient graphical summary of
hypothesis tests in multivariate linear model. They plot a data ellipse
for the residuals in the model, representing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐄</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>
matrix in the test statistics (Roy’s maximum root test, Pillai and
Hotelling trace criteria and Wilks’ Lambda). Overlaid on this are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐇</mi><annotation encoding="application/x-tex">\mathbf{H}</annotation></semantics></math>
ellipses for each term in the model, representing the data ellipses for
the fitted values. Using Roy’s test, these have a convenient
interpretation: a term is significant <em>iff</em> the H ellipse
projects anywhere outside the E ellipse. For a 1 df (regression)
variable, the H ellipse collapses to a line.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span><span class="va">crime.mod</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.05</span>, </span>
<span>       cex<span class="op">=</span><span class="fl">1.4</span>, cex.lab<span class="op">=</span><span class="fl">1.3</span> <span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/heplot-1.png" width="480"></p>
<p>In this plot, the effect of <code>Suicides</code> is completely
aligned with crimes against property. The effect of <code>Region</code>
is positively correlated with both types of crime. The means for the
regions show that the South of France is lower (worse) on personal
crime; the other regions vary most in property crime, with the North
being lower and the Center being higher.</p>
</div>
<div class="section level4">
<h4 id="canonical-plots">Canonical plots<a class="anchor" aria-label="anchor" href="#canonical-plots"></a>
</h4>
<p>The HE plot displays these relations in <strong>data space</strong>.
An alternative is provided by canonical discriminant analysis, which
finds the weighted sums of the response variables leading to the largest
test statistics for the terms, which can be visualized in
<strong>canonical space</strong>.</p>
<p>The analysis below reflects the effect of <code>Region</code> in
relation to both crime variables.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crime.can</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://friendly.github.io/candisc/reference/candisc.html" class="external-link">candisc</a></span><span class="op">(</span><span class="va">crime.mod</span><span class="op">)</span></span>
<span><span class="va">crime.can</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Canonical Discriminant Analysis for Region:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     CanRsq Eigenvalue Difference Percent Cumulative</span></span>
<span><span class="co">#&gt; 1 0.322365    0.47572    0.36879  81.647     81.647</span></span>
<span><span class="co">#&gt; 2 0.096603    0.10693    0.36879  18.353    100.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test of H0: The canonical correlations in the </span></span>
<span><span class="co">#&gt; current row and all that follow are zero</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LR test stat approx F numDF denDF   Pr(&gt; F)    </span></span>
<span><span class="co">#&gt; 1      0.61217   5.4924     8   158 3.993e-06 ***</span></span>
<span><span class="co">#&gt; 2      0.90340   2.8515     3    80   0.04248 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The HE plot for this analysis is shown below. Variable vector
represent the correlations of the crime variables with the canonical
dimension.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span><span class="va">crime.can</span>, fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>       var.col <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>       var.cex <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>       cex<span class="op">=</span><span class="fl">1.4</span>, cex.lab<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="guerry-multivariate_files/figure-html/hecan-1.png" width="480"></p>
<pre><code><span><span class="co">#&gt; Vector scale factor set to  3.014304</span></span></code></pre>
<p>This gives a simple interpretation of the differences in
<code>Region</code> on the crime variables. The first canonical
dimension accounts for 83% of differences among the regions, and this is
nearly perfectly aligned with personal crime, with the largest
difference between the South and the other regions. The second canonical
dimension, accounting for the remaining 17%, is perfectly aligned with
property crime. On this dimension, the North stands out compared to the
other regions.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-FoxFriendlyMonette:09:compstat" class="csl-entry">
Fox, J., M. Friendly, and G. Monette. 2009. <span>“Visualizing
Hypothesis Tests in Multivariate Linear Models: The <em>Heplots</em>
Package for <span>R</span>.”</span> <em>Computational Statistics</em> 24
(2): 233–46. <a href="https://datavis.ca/papers/FoxFriendlyMonette-2009.pdf" class="external-link">https://datavis.ca/papers/FoxFriendlyMonette-2009.pdf</a>.
</div>
<div id="ref-R-car" class="csl-entry">
Fox, John, Sanford Weisberg, and Brad Price. 2024. <em>Car: Companion to
Applied Regression</em>. <a href="https://r-forge.r-project.org/projects/car/" class="external-link">https://r-forge.r-project.org/projects/car/</a>.
</div>
<div id="ref-Friendly:02:corrgram" class="csl-entry">
Friendly, Michael. 2002. <span>“Corrgrams: Exploratory Displays for
Correlation Matrices.”</span> <em>The American Statistician</em> 56 (4):
316–24. <a href="http://datavis.ca/papers/corrgram.pdf" class="external-link">http://datavis.ca/papers/corrgram.pdf</a>.
</div>
<div id="ref-Friendly:2007:heplots" class="csl-entry">
———. 2007. <span>“HE Plots for Multivariate General Linear
Models.”</span> <em>Journal of Computational and Graphical
Statistics</em> 16 (4): 421–44. <a href="http://datavis.ca/papers/jcgs-heplots.pdf" class="external-link">http://datavis.ca/papers/jcgs-heplots.pdf</a>.
</div>
<div id="ref-heplots" class="csl-entry">
Friendly, Michael, John Fox, and and Georges Monette. 2022. <em><span class="nocase">heplots</span>: Visualizing Tests in Multivariate Linear
Models</em>. <a href="https://CRAN.R-project.org/package=heplots" class="external-link">https://CRAN.R-project.org/package=heplots</a>.
</div>
<div id="ref-FriendlyKwan:02:effect" class="csl-entry">
Friendly, M., and E. Kwan. 2003. <span>“Effect Ordering for Data
Displays.”</span> <em>Computational Statistics and Data Analysis</em> 43
(4): 509–39. <a href="https://doi.org/10.1016/S0167-9473(02)00290-6" class="external-link">https://doi.org/10.1016/S0167-9473(02)00290-6</a>.
</div>
<div id="ref-Galton:1886" class="csl-entry">
Galton, Francis. 1886. <span>“Regression Towards Mediocrity in
Hereditary Stature.”</span> <em>Journal of the Anthropological
Institute</em> 15: 246–63.
</div>
<div id="ref-Guerry:1833" class="csl-entry">
Guerry, André-Michel. 1833. <em>Essai Sur La Statistique Morale de La
<span>France</span></em>. Paris: Crochard.
</div>
<div id="ref-R-GGally" class="csl-entry">
Schloerke, Barret, Di Cook, Joseph Larmarange, Francois Briatte, Moritz
Marbach, Edwin Thoen, Amos Elberg, and Jason Crowley. 2024. <em>GGally:
Extension to Ggplot2</em>. <a href="https://ggobi.github.io/ggally/" class="external-link">https://ggobi.github.io/ggally/</a>.
</div>
<div id="ref-R-ggbiplot" class="csl-entry">
Vu, Vincent Q., and Michael Friendly. 2024. <em>Ggbiplot: A Grammar of
Graphics Implementation of Biplots</em>. <a href="https://github.com/friendly/ggbiplot" class="external-link">https://github.com/friendly/ggbiplot</a>.
</div>
<div id="ref-R-corrgram" class="csl-entry">
Wright, Kevin. 2021. <em>Corrgram: Plot a Correlogram</em>. <a href="https://kwstat.github.io/corrgram/" class="external-link">https://kwstat.github.io/corrgram/</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, Stephane Dray.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
