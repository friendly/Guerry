[{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"load-data-and-packages","dir":"Articles","previous_headings":"","what":"Load data and packages","title":"Guerry data: Multivariate Analysis","text":"primarily use following packages, load now.","code":"library(Guerry)         # Guerry data library(car)            # better scatterplots library(effects)        # Effect Displays for Linear Models library(ggplot2)        # Elegant Data Visualisations Using the Grammar of Graphics library(ggrepel)        # better handling of text labels library(patchwork)      # combine plots library(heplots)        # Hypothesis-Error plots library(candisc)        # Visualizing Generalized Canonical Discriminant Analysis library(dplyr)          # A Grammar of Data Manipulation library(tidyr)          # Tidy Messy Data data(Guerry)"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"guerry-data-set","dir":"Articles","previous_headings":"Load data and packages","what":"Guerry data set","title":"Guerry data: Multivariate Analysis","text":"Guerry‚Äôs (1833) data consisted six main moral variables shown table . wanted recorded aligned scales larger numbers consistently reflected ‚Äúmorally better‚Äù. Thus, four variables recorded inverse form, ‚ÄúPopulation per ‚Ä¶‚Äù. Guerry data set also contains: dept Department, French ID numbers names 86 d√©partements metropolitan France 1830, including Corsica. Region: factor main levels ‚ÄúN‚Äù, ‚ÄúS‚Äù, ‚ÄúE‚Äù, ‚ÄúW‚Äù, ‚ÄúC‚Äù. Corsica coded NA. collection 14 related variables sources time. See ?Guerry precise definitions. Among , aspects criminal behavior, see crime parents, Infanticide Prostitutes. Clergy Donations_clergy considered measures moral rectitude, potentially counteracting crime.","code":"names(Guerry)[-(1:9)] #>  [1] \"MainCity\"        \"Wealth\"          \"Commerce\"        \"Clergy\"          #>  [5] \"Crime_parents\"   \"Infanticide\"     \"Donation_clergy\" \"Lottery\"         #>  [9] \"Desertion\"       \"Instruction\"     \"Prostitutes\"     \"Distance\"        #> [13] \"Area\"            \"Pop1831\""},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"guerrys-questions","dir":"Articles","previous_headings":"Load data and packages","what":"Guerry‚Äôs questions","title":"Guerry data: Multivariate Analysis","text":"main questions concerned Guerry whether indicators crime shown related factors might considered ameliorate crime. Among , Guerry focused Literacy defined number military conscripts mark ‚ÄúX‚Äù enrollment form. related variable Instruction, rank recorded Guerry‚Äôs map; defined, inversely related Literacy. potential explanatory variables : Donations (measure donations poor), Donation_clergy (measure donations clergy) Clergy (rank number Catholic priests active service, per population)","code":""},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"multivariate-visualization-methods","dir":"Articles","previous_headings":"","what":"Multivariate visualization methods","title":"Guerry data: Multivariate Analysis","text":"Visualization methods multivariate data take enormous variety forms simply two dimensions data offer exponentially increasingly possibilities. useful distinguish several broad categories: data plots : primarily plot raw data, often annotations aid interpretation (regression lines smooths, data ellipses, marginal distributions) model plots : primarily plot results fitted model, considering fitted model may involve variables can shown static 2D plot. examples : Added variable plots, effect plots, coefficient plots, ‚Ä¶ diagnostic plots : indicating potential problems fitted model. include residual plots, influence plots, plots testing homogeneity variance forth. dimension reduction plots : plot representations data space fewer dimensions number variables data set. Simple examples include principal components analysis (PCA) related biplots, multidimensional scaling (MDS) methods.","code":""},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"data-plots","dir":"Articles","previous_headings":"","what":"Data plots","title":"Guerry data: Multivariate Analysis","text":"Data plots portray data space coordinate axes observed variables. 1D plots include line plots, histograms density estimates 2D plots often scatterplots, contour plots hex-binned plots also useful sample size large. higher dimensions, biplots, showing data principal components space, together vectors representing correlations among variables, often useful.","code":""},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"density-plots","dir":"Articles","previous_headings":"Data plots","what":"Density plots","title":"Guerry data: Multivariate Analysis","text":"useful examine distributions variables density plots quite informative. want 6 main variables, ‚Äôll use trick tidy data analysis ggplot2: Reshape data wide long. gives guerry_long, different variables column labeled variable values value. Plot density, make different subplot facet_wrap(~ variable). plots different scales X Y (density) values, important use scales=\"FREE\". Moreover, ‚Äôm primarily interested shape distributions, suppress Y axis tick marks labels.  can see variables positively skewed, Donations, Infants Suicides particularly , much cause alarm. also interest see whether distributions differ according Region. easy , using aes(... fill=Region) variables, like Infants Suicides differences seem particularly large. However, crime variables Literacy show marked differences across region.","code":"data(\"Guerry\", package=\"Guerry\") guerry_long <- Guerry |>   filter(!is.na(Region)) |>   select(dept:Suicides) |>   pivot_longer(cols = Crime_pers:Suicides,                names_to = \"variable\",                values_to = \"value\") guerry_long #> # A tibble: 510 √ó 5 #>     dept Region Department variable   value #>    <int> <fct>  <fct>      <chr>      <int> #>  1     1 E      Ain        Crime_pers 28870 #>  2     1 E      Ain        Crime_prop 15890 #>  3     1 E      Ain        Literacy      37 #>  4     1 E      Ain        Donations   5098 #>  5     1 E      Ain        Infants    33120 #>  6     1 E      Ain        Suicides   35039 #>  7     2 N      Aisne      Crime_pers 26226 #>  8     2 N      Aisne      Crime_prop  5521 #>  9     2 N      Aisne      Literacy      51 #> 10     2 N      Aisne      Donations   8901 #> # ‚Ñπ 500 more rows ggplot(data = guerry_long,        aes(x=value, fill=TRUE)) +   geom_density(alpha=0.2) +   geom_rug() +   facet_wrap(~variable, scales=\"free\") +   theme_bw(base_size = 14) +   theme(legend.position = \"none\",         axis.ticks.y=element_blank(),         axis.text.y=element_blank()) col.region   <- colors()[c(149, 254, 468, 552, 26)] # colors for region ggplot(data = guerry_long,        aes(x=value, fill=Region)) +   geom_density(alpha=0.2) +   geom_rug() +   facet_wrap(~variable, scales=\"free\") +   scale_fill_manual(values=col.region) +   theme_bw(base_size = 14) +   theme(legend.position = \"bottom\",         axis.ticks.y=element_blank(),         axis.text.y=element_blank())"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"bivariate-relations","dir":"Articles","previous_headings":"Data plots","what":"Bivariate relations","title":"Guerry data: Multivariate Analysis","text":"Let‚Äôs start plots crime (Crime_pers Crime_prop) relation Literacy. simple scatterplot informative. can seen much relation personal crime literacy.  useful scatterplots annotated additional statistical summaries aid interpretation: linear regression line, smoothed non-parametric (loess) curve, diagnose potential non-linear relations, data ellipses, highlight overall trend variability, point labels potentially outlying influential points. use ggplot2 . provides features, except label unusual points, calculate Mahalanobis squared distance points grand means.  flat (blue) regression line nearly circular data ellipses show correlation nearly zero; smoothed (red) curve indicates tendency nonlinear relation. crimes property:  , somewhat surprisingly, increased literacy associated increase property crime (greater population per crime) opposed situation personal crime, seems unrelated literacy. Creuse stands unusual point, one likely influential regression models.","code":"ggplot(aes(x=Literacy, y=Crime_pers/1000), data=Guerry) +   geom_point(size=2) gdf <- Guerry[, c(\"Literacy\", \"Crime_pers\", \"Department\")] gdf$dsq <- mahalanobis(gdf[,1:2], colMeans(gdf[,1:2]), cov(gdf[,1:2]))  ggplot(aes(x=Literacy, y=Crime_pers/1000, label=Department), data=gdf) +   geom_point(size=2) +   stat_ellipse(level=0.68, color=\"blue\", size=1.2) +     stat_ellipse(level=0.95, color=\"gray\", size=1, linetype=2) +    geom_smooth(method=\"lm\", formula=y~x, fill=\"lightblue\") +   geom_smooth(method=\"loess\", formula=y~x, color=\"red\", se=FALSE) +   geom_label_repel(data = gdf[gdf$dsq > 4.6,]) +   theme_bw() gdf <- Guerry[, c(\"Literacy\", \"Crime_prop\", \"Department\")] gdf$dsq <- mahalanobis(gdf[,1:2], colMeans(gdf[,1:2]), cov(gdf[,1:2]))  ggplot(aes(x=Literacy, y=Crime_prop/1000, label=Department), data=gdf) +   geom_point(size=2) +   stat_ellipse(level=0.68, color=\"blue\", size=1.2) +     stat_ellipse(level=0.95, color=\"gray\", size=1, linetype=2) +    geom_smooth(method=\"lm\", formula=y~x, fill=\"lightblue\") +   geom_smooth(method=\"loess\", formula=y~x, color=\"red\", se=FALSE) +   geom_label_repel(data = gdf[gdf$dsq > 4.6,]) +   theme_bw()"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"reconnaisance-plots","dir":"Articles","previous_headings":"Data plots","what":"Reconnaisance plots","title":"Guerry data: Multivariate Analysis","text":"Reconnaisance plots attempt give bird‚Äôs-eye overview multivariate data set. example, see relations among two variables turn scatterplot matrix display show pairwise bivariate relations. , preferred package car (John Fox, Weisberg, Price 2023) scatterplotMatrix function. GGally (Schloerke et al. 2021) works within ggplot2 framework, doesn‚Äôt flexibility ‚Äôd like.","code":"library(car)          # Companion to Applied Regression scatterplotMatrix(Guerry[,4:9],                   ellipse=list(levels=0.68),                    smooth=FALSE)"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"corrgrams","dir":"Articles","previous_headings":"Data plots > Reconnaisance plots","what":"Corrgrams","title":"Guerry data: Multivariate Analysis","text":"Sometimes, particularly variables , want see schematic overview. correlation diagram ‚Äúcorrgram‚Äù (Friendly 2002) graphic display correlation matrix, allowing different renderings correlation pair variables: shaded box, pie symbol, schematic data ellipse, options. implemented corrgram package (Wright 2021). panels upper lower triangles can rendered differently.  , data pairwise tile can rendered data ellipses smoothed curves show possible nonlinear relations. Another feature rows/column variables can permuted put similar variables together, using order option, arranges variables according similarity correlations.  , number pairwise plots appear markedly nonlinear. main crime variables, nonlinear personal crime vs.¬†donations poor, property crime vs. infants born wedlock suicides. Literacy stands negative relations variables. alternative analysis might include: converting data ranks. considering transformations variables","code":"library(corrgram)             # Plot a Correlogram corrgram(Guerry[,4:9], upper=panel.pie) corrgram(Guerry[,4:9],           upper=panel.ellipse,           order=TRUE,          lwd=2)"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"biplots","dir":"Articles","previous_headings":"Data plots","what":"Biplots","title":"Guerry data: Multivariate Analysis","text":"Rather viewing data data space, biplot shows data reduced-rank PCA space explains variation observations. essentially plot observation scores first principal component overlaid vectors representing variables projected PCA space. First, use prcomp() carry PCA. ‚Äôd like visualize result relation Region, delete Corsica Region missing. ggplot2 framework, biplots can produced ggbiplot package (Vu 2011), package CRAN, directly used vignette. Instead, code run locally result included.  OK, many features plots customized (line widths, colors, ‚Ä¶ ). prefer created using heplots package.  interpretation can read directions variable arrows relative positions ellipses representing scatter component scores different regions. first component largely aligned positively Literacy negatively property crime, suicides children born wedlock (Infants) second dimension reflects mainly correlation personal crime donations poor. South region generally lower PC2, West, generally higher. North stands higher others PC1; West somewhat higher PC2.","code":"gdata <- Guerry |>   select(Region, Crime_pers:Suicides) |>   # keep only main variables   filter(!is.na(Region))                   # delete Corsica (Region==NA)  guerry.pca <- gdata |>   select(-Region) |>   prcomp(scale = TRUE)  print(guerry.pca, digits=3) #> Standard deviations (1, .., p=6): #> [1] 1.463 1.096 1.050 0.817 0.741 0.584 #>  #> Rotation (n x k) = (6 x 6): #>                PC1     PC2     PC3      PC4     PC5     PC6 #> Crime_pers -0.0659  0.5906  0.6732 -0.13973 -0.0102 -0.4172 #> Crime_prop -0.5123 -0.0884  0.4765  0.09861  0.1381  0.6884 #> Literacy    0.5118 -0.1294  0.2090 -0.00797  0.8213  0.0560 #> Donations  -0.1062  0.6990 -0.4134  0.47298  0.2742  0.1741 #> Infants    -0.4513  0.1033 -0.3238 -0.73031  0.3776 -0.0696 #> Suicides   -0.5063 -0.3569  0.0169  0.46220  0.2976 -0.5602 if(!require(ggbiplot)) remotes::install_github(\"vqv/ggbiplot\") library(ggbiplot) # A ggplot2 based biplot ggbiplot(guerry.pca, groups=gdata$Region,           ellipse=TRUE,          var.scale = 3, varname.size = 5) +    theme_bw() +    labs(color=\"Region\") +   theme(legend.position = c(0.1, 0.8)) knitr::include_graphics(\"figures/ggbiplot.png\") op <- par(mar=c(5,4,1,1)+.1) cols = colorspace::rainbow_hcl(5) covEllipses(guerry.pca$x,              group=gdata$Region,              pooled=FALSE,              fill=TRUE, fill.alpha=0.1,             col=cols,              label.pos=c(3,0,1,1,3),              cex=2,             xlim=c(-4,4), ylim=c(-4,4),             xlab = \"Dimension 1 (35.7 %)\",              ylab = \"Dimension 2 (20.0 %)\",             cex.lab=1.4             ) points(guerry.pca$x, pch=(15:19)[Guerry$Region], col=cols[Guerry$Region])  candisc::vectors(guerry.pca$rotation, scale=5,                    col=\"black\", lwd=3, cex=1.4,                   pos = c(4,2,4,2,2,2),                  xpd=TRUE) abline(h=0, v=0, col=gray(.70))"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"models","dir":"Articles","previous_headings":"","what":"Models","title":"Guerry data: Multivariate Analysis","text":"illustrate: Model based plots linear regression models predicting personal crime property crime Multivariate analysis variance (MANOVA) plots joint relation crime variables predictors.","code":""},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"predicting-crime-univariate-regression","dir":"Articles","previous_headings":"Models","what":"Predicting crime: Univariate regression","title":"Guerry data: Multivariate Analysis","text":"simplest approach predicting crime variables fit separate multiple regression . Tests predictors best obtained using car::Anova() gives partial (Type II) tests, adjusting predictors, rather sequential (Type ) tests provided stats::anova() somewhat disappointing look significance stars: Region significant personal crime Suicides property crime. evidence argument, supported liberal hygenicists Guerry‚Äôs time, increased Literacy reduce crime. models, can understand nature predicted effects using effects package. (marginal) effect given term gives predicted values, averaging terms model.  property crime, get:","code":"crime.mod1 <- lm(Crime_pers ~  Region + Literacy + Donations +  Infants + Suicides, data=Guerry) crime.mod2 <- lm(Crime_prop ~  Region + Literacy + Donations +  Infants + Suicides, data=Guerry) Anova(crime.mod1) #> Anova Table (Type II tests) #>  #> Response: Crime_pers #>               Sum Sq Df F value    Pr(>F)     #> Region    1388267847  4  9.0398 5.005e-06 *** #> Literacy    77140249  1  2.0092    0.1604     #> Donations   54505520  1  1.4197    0.2372     #> Infants       102152  1  0.0027    0.9590     #> Suicides      205432  1  0.0054    0.9419     #> Residuals 2917886368 76                       #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 Anova(crime.mod2) #> Anova Table (Type II tests) #>  #> Response: Crime_prop #>              Sum Sq Df F value    Pr(>F)     #> Region     52269436  4  2.0939 0.0898250 .   #> Literacy   13366819  1  2.1419 0.1474514     #> Donations   9218353  1  1.4771 0.2279870     #> Infants     7577617  1  1.2142 0.2739759     #> Suicides  100890796  1 16.1665 0.0001355 *** #> Residuals 474296314 76                       #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 plot(predictorEffects(crime.mod1, ~ Region + Literacy + Infants + Suicides),       lwd=2, main=\"\") plot(predictorEffects(crime.mod2, ~ Region + Literacy + Infants + Suicides),       lwd=2, main=\"\")"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"predicting-crime-multivariate-regression","dir":"Articles","previous_headings":"Models","what":"Predicting crime: Multivariate regression","title":"Guerry data: Multivariate Analysis","text":"two regression models can fit together multivariate regression crime variables jointly. quick check assumption residuals bivariate normally distributed check outliers, œá2\\chi^2 Q-Q plot graphs squared Mahalanobis distances residuals corresponding œá22\\chi^2_2 quantiles bivariate normal distribution. data Creuse stands potential outlier.","code":"crime.mod <- lm(cbind(Crime_pers, Crime_prop) ~                  Region + Literacy + Donations +  Infants + Suicides, data=Guerry) Anova(crime.mod) #>  #> Type II MANOVA Tests: Pillai test statistic #>           Df test stat approx F num Df den Df    Pr(>F)     #> Region     4   0.42933   5.1936      8    152 9.563e-06 *** #> Literacy   1   0.03707   1.4434      2     75 0.2425951     #> Donations  1   0.02615   1.0071      2     75 0.3701736     #> Infants    1   0.01833   0.7001      2     75 0.4997450     #> Suicides   1   0.20772   9.8315      2     75 0.0001615 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 labels <- paste0(Guerry$dept,\":\", Guerry$Department) cqplot(crime.mod, id.n=4, labels=labels)"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"he-plots","dir":"Articles","previous_headings":"Models > Predicting crime: Multivariate regression","what":"HE plots","title":"Guerry data: Multivariate Analysis","text":"Hypothesis-Error () plots (Friendly 2007; J. Fox, Friendly, Monette 2009; Friendly, Fox, Georges Monette 2022) provide convenient graphical summary hypothesis tests multivariate linear model. plot data ellipse residuals model, representing ùêÑ\\mathbf{E} matrix test statistics (Roy‚Äôs maximum root test, Pillai Hotelling trace criteria Wilks‚Äô Lambda). Overlaid ùêá\\mathbf{H} ellipses term model, representing data ellipses fitted values. Using Roy‚Äôs test, convenient interpretation: term significant iff H ellipse projects anywhere outside E ellipse. 1 df (regression) variable, H ellipse collapses line.  plot, effect Suicides completely aligned crimes property. effect Region positively correlated types crime. means regions show South France lower (worse) personal crime; regions vary property crime, North lower Center higher.","code":"heplot(crime.mod,         fill=TRUE, fill.alpha=0.05,         cex=1.4, cex.lab=1.3 )"},{"path":"http://friendly.github.io/Guerry/articles/guerry-multivariate.html","id":"canonical-plots","dir":"Articles","previous_headings":"Models > Predicting crime: Multivariate regression","what":"Canonical plots","title":"Guerry data: Multivariate Analysis","text":"plot displays relations data space. alternative provided canonical discriminant analysis, finds weighted sums response variables leading largest test statistics terms, can visualized canonical space. analysis reflects effect Region relation crime variables. plot analysis shown . Variable vector represent correlations crime variables canonical dimension.  gives simple interpretation differences Region crime variables. first canonical dimension accounts 83% differences among regions, nearly perfectly aligned personal crime, largest difference South regions. second canonical dimension, accounting remaining 17%, perfectly aligned property crime. dimension, North stands compared regions.","code":"crime.can <- candisc(crime.mod) crime.can #>  #> Canonical Discriminant Analysis for Region: #>  #>     CanRsq Eigenvalue Difference Percent Cumulative #> 1 0.337068    0.50845    0.40681   83.34      83.34 #> 2 0.092267    0.10164    0.40681   16.66     100.00 #>  #> Test of H0: The canonical correlations in the  #> current row and all that follow are zero #>  #>   LR test stat approx F numDF denDF   Pr(> F)     #> 1      0.60177   5.7097     8   158 2.209e-06 *** #> 2      0.90773   2.7105     3    80   0.05051 .   #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 heplot(crime.can, fill=TRUE, fill.alpha=0.1,        var.col = \"black\",         var.cex = 1.3,        cex=1.4, cex.lab=1.3) #> Vector scale factor set to  3.10537"},{"path":[]},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"preliminary-steps","dir":"Articles","previous_headings":"","what":"Preliminary steps","title":"Guerry data: Spatial Multivariate Analysis","text":"Several packages required run different analyses loaded. ade4 package multivariate analysis supplemented adegraphics (associated graphical methods) adespatial multivariate spatial analysis. information spatial analysis approach, see vignette(package=\"adespatial\", \"tutorial\"). Guerry gathered data crimes, suicide, literacy moral statistics various d√©partements (.e., counties) France. provided first real social data analysis, using graphics maps summarize georeferenced multivariate dataset. use dataset gfrance85 consider six key quantitative variables (shown table ) 85 d√©partements France 1830 (Corsica, island often outlier, excluded). Data recorded aligned scales larger numbers consistently reflect ‚Äúmorally better‚Äù. Thus, four ‚Äúbad‚Äù variables recorded inverse form, ‚ÄúPopulation per ‚Ä¶‚Äù. scaling, expected correlations ‚â•0\\ge 0. dataset gfrance85 actually SpatialPolygonsDataFrame object created sp package. contains polygon boundaries map France 1830, well variables Guerry data frame. ordinary data.frame, components simplify analyses, extract components used .","code":"library(Guerry)       # Guerry's data library(sp)           # management of spatial data library(ade4)         # multivariate analysis library(adegraphics)  # graphical representation library(spdep)        # spatial dependency library(adespatial)   # multivariate spatial analysis names(gfrance85) #>  [1] \"CODE_DEPT\"       \"COUNT\"           \"AVE_ID_GEO\"      \"dept\"            #>  [5] \"Region\"          \"Department\"      \"Crime_pers\"      \"Crime_prop\"      #>  [9] \"Literacy\"        \"Donations\"       \"Infants\"         \"Suicides\"        #> [13] \"MainCity\"        \"Wealth\"          \"Commerce\"        \"Clergy\"          #> [17] \"Crime_parents\"   \"Infanticide\"     \"Donation_clergy\" \"Lottery\"         #> [21] \"Desertion\"       \"Instruction\"     \"Prostitutes\"     \"Distance\"        #> [25] \"Area\"            \"Pop1831\" data(gfrance85)  df           <- data.frame(gfrance85)[, 7:12]    # the 6 variables  france.map   <- as(gfrance85, \"SpatialPolygons\") # the map  xy           <- coordinates(gfrance85)           # spatial coordinates  dep.names    <- data.frame(gfrance85)[, 6]       # departement names  region.names <- data.frame(gfrance85)[, 5]       # region names  col.region   <- colors()[c(149, 254, 468, 552, 26)] # colors for region"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"standard-approaches","dir":"Articles","previous_headings":"","what":"Standard approaches","title":"Guerry data: Spatial Multivariate Analysis","text":"section, focus classical approaches consider either multivariate spatial aspect data.","code":""},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"multivariate-analysis","dir":"Articles","previous_headings":"Standard approaches","what":"Multivariate analysis","title":"Guerry data: Spatial Multivariate Analysis","text":"consider p=6p=6 variables measured n=85n=85 individuals (d√©partements France). quantitative variables recorded, principal component analysis (PCA, Hotelling 1933) well adapted. PCA summarizes data maximizing simultaneously variance projection individuals onto principal axes sum squared correlations principal component variables. biplot simply obtained  first two PCA dimensions account 35.7% 20% ,respectively, total variance. Correlations variables principal components can represented correlation circle. first axis negatively correlated literacy positively correlated property crime, suicides illegitimate births. second axis aligned mainly personal crime donations poor.  Spatial information can added factorial map representing projections d√©partements principal axes coloring according colors representing different regions France.   first axis, North East characterized negative scores, corresponding high levels literacy high rates suicides, crimes property illegitimate births. second axis mainly contrasts West (high donations poor low levels crime persons) South.","code":"pca <- dudi.pca(df, scannf = FALSE, nf = 3) biplot(pca, plabel.cex = 0.8) pca$eig/sum(pca$eig) * 100 #> [1] 35.674507 20.013665 18.367448 11.116102  9.144584  5.683694 s.corcircle(pca$co) s.label(pca$li, ppoint.col = col.region[region.names], plabel.optim = TRUE, plabel.cex = 0.6) s.Spatial(france.map, col = col.region[region.names], plabel.cex = 0) s.class(xy, region.names, col = col.region, add = TRUE, ellipseSize = 0, starSize = 0)"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"spatial-autocorrelation","dir":"Articles","previous_headings":"Standard approaches","what":"Spatial autocorrelation","title":"Guerry data: Spatial Multivariate Analysis","text":"Spatial autocorrelation statistics, Moran (1948) Coefficient (MC) Geary (1954) Ratio, aim measure analyze degree dependency among observations geographical context (Cliff Ord 1973).","code":""},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"the-spatial-weighting-matrix","dir":"Articles","previous_headings":"Standard approaches > Spatial autocorrelation","what":"The spatial weighting matrix","title":"Guerry data: Spatial Multivariate Analysis","text":"first step spatial autocorrelation analysis define spatial weighting matrix ùêñ=[wij]\\mathbf{W}=[w_{ij}] . case Guerry‚Äôs data, simply defined binary neighborhood two d√©partements considered neighbors share common border. spatial weighting matrix obtained row-standardization (style = \"W\"): can represent neighborhood geographical map:","code":"nb <- poly2nb(gfrance85) lw <- nb2listw(nb, style = \"W\") s.Spatial(france.map, nb = nb, plabel.cex = 0, pSp.border = \"white\")"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"morans-coefficient","dir":"Articles","previous_headings":"Standard approaches > Spatial autocorrelation","what":"Moran‚Äôs Coefficient","title":"Guerry data: Spatial Multivariate Analysis","text":"spatial weights defined, spatial autocorrelation statistics can computed. Let us consider nn--1 vector ùê±=[x1‚ãØxn]T\\mathbf{x}=\\left[ {x_1 \\cdots x_n } \\right]^\\textrm{T} containing measurements quantitative variable nn spatial units. usual formulation Moran‚Äôs coefficient spatial autocorrelation (Cliff Ord 1973; Moran 1948) MC(ùê±)=n‚àë(2)wij(xi‚àíx‚Äæ)(xj‚àíx‚Äæ)‚àë(2)wij‚àë=1n(xi‚àíx‚Äæ)2 ‚àë(2)=‚àë=1n‚àëj=1n ‚â†j.\\begin{equation} \\label{eq1} MC(\\mathbf{x})=\\frac{n\\sum\\nolimits_{\\left( 2 \\right)} {w_{ij} (x_i -\\bar  {x})(x_j -\\bar {x})} }{\\sum\\nolimits_{\\left( 2 \\right)} {w_{ij} }  \\sum\\nolimits_{=1}^n {(x_i -\\bar {x})^2} }\\mbox{  }\\sum\\nolimits_{\\left( 2 \\right)} =\\sum\\limits_{=1}^n {\\sum\\limits_{j=1}^n  } \\mbox{ }\\ne j. \\end{equation} MC can rewritten using matrix notation: MC(ùê±)=nùüèTùêñùüèùê≥Tùêñùê≥ùê≥Tùê≥,\\begin{equation} \\label{eq2} MC(\\mathbf{x})=\\frac{n}{\\mathbf{1}^\\textrm{T}\\mathbf{W1}}\\frac{\\mathbf{z}^\\textrm{T}{\\mathbf{Wz}}}{\\mathbf{z}^\\textrm{T}\\mathbf{z}}, \\end{equation} ùê≥=(ùêàn‚àíùüènùüènT/n)ùê±\\mathbf{z}=\\left ( \\mathbf{}_n-\\mathbf{1}_n\\mathbf{1}_n^\\textrm{T} /n \\right )\\mathbf{x} vector centered values (zi=xi‚àíx‚Äæz_i=x_i-\\bar{x}) ùüèn\\mathbf{1}_n vector ones (length nn). significance observed value MC can tested Monte-Carlo procedure, locations permuted obtain distribution MC null hypothesis random distribution. observed value MC greater expected random indicates clustering similar values across space (positive spatial autocorrelation), significant negative value MC indicates neighboring values dissimilar expected chance (negative spatial autocorrelation). computed MC Guerry‚Äôs dataset. positive significant autocorrelation identified six variables. Thus, values literacy covariant adjacent departments, illegitimate births (Infants) covary least.","code":"moran.randtest(df, lw) #> class: krandtest lightkrandtest  #> Monte-Carlo tests #> Call: moran.randtest(x = df, listw = lw) #>  #> Number of tests:   6  #>  #> Adjustment method for multiple comparisons:   none  #> Permutation number:   999  #>         Test       Obs   Std.Obs   Alter Pvalue #> 1 Crime_pers 0.4114597  6.119865 greater  0.001 #> 2 Crime_prop 0.2635533  4.012029 greater  0.002 #> 3   Literacy 0.7176053 10.195629 greater  0.001 #> 4  Donations 0.3533613  5.145807 greater  0.001 #> 5    Infants 0.2287241  3.705080 greater  0.002 #> 6   Suicides 0.4016812  6.265266 greater  0.001"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"moran-scatterplot","dir":"Articles","previous_headings":"Standard approaches > Spatial autocorrelation","what":"Moran scatterplot","title":"Guerry data: Spatial Multivariate Analysis","text":"spatial weighting matrix row-standardized, can define lag vector ùê≥ÃÉ=ùêñùê≥\\mathbf{\\tilde{z}} = \\mathbf{Wz} (.e., zÃÉ=‚àëj=1nwijxj\\tilde{z}_i = \\sum\\limits_{j=1}^n{w_{ij}x_j}) composed weighted (spatial weighting matrix) averages neighboring values. Thus, : MC(ùê±)=ùê≥Tùê≥ÃÉùê≥Tùê≥,\\begin{equation} \\label{eq3} MC(\\mathbf{x})=\\frac{\\mathbf{z}^\\textrm{T}{\\mathbf{\\tilde{z}}}}{\\mathbf{z}^\\textrm{T}\\mathbf{z}}, \\end{equation} since case ùüèTùêñùüè=n\\mathbf{1}^\\textrm{T}\\mathbf{W1}=n. shows clearly MC measures autocorrelation giving indication intensity linear association vector observed values ùê≥\\mathbf{z} vector weighted averages neighboring values ùê≥ÃÉ\\mathbf{\\tilde{z}}. Anselin (1996) proposed visualize MC form bivariate scatterplot ùê≥ÃÉ\\mathbf{\\tilde{z}} ùê≥\\mathbf{z}. linear regression can added Moran scatterplot, slope equal MC. Considering Literacy variable Guerry‚Äôs data, Moran scatterplot clearly shows strong autocorrelation. also shows Hautes-Alpes d√©partement slightly outlying position characterized high value Literacy compared neighbors.","code":"x <- df[, 3] x.lag <- lag.listw(lw, df[, 3]) moran.plot(x, lw) text(x[5], x.lag[5], dep.names[5], pos = 1, cex = 0.8)"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"indirect-integration-of-multivariate-and-geographical-aspects","dir":"Articles","previous_headings":"Standard approaches","what":"Indirect integration of multivariate and geographical aspects","title":"Guerry data: Spatial Multivariate Analysis","text":"simplest approach considered two-step procedure data first summarized multivariate analysis PCA. second step, univariate spatial statistics mapping techniques applied PCA scores axis separately. One can also test presence spatial autocorrelation first scores analysis, univariate autocorrelation statistics MC. mapped scores d√©partements first two axes PCA Guerry‚Äôs data. Even PCA maximizes variance scores, also clear spatial structure, scores highly autocorrelated. map first axis corresponds closely split la France √©clair√©e (North-East characterized higher level Literacy) la France obscure.","code":"moran.randtest(pca$li, lw) #> class: krandtest lightkrandtest  #> Monte-Carlo tests #> Call: moran.randtest(x = pca$li, listw = lw) #>  #> Number of tests:   3  #>  #> Adjustment method for multiple comparisons:   none  #> Permutation number:   999  #>    Test       Obs  Std.Obs   Alter Pvalue #> 1 Axis1 0.5506343 8.330755 greater  0.001 #> 2 Axis2 0.5614030 8.010169 greater  0.001 #> 3 Axis3 0.1805569 2.855507 greater  0.003 s.value(xy, pca$li[, 1:2], Sp = france.map, pSp.border = \"white\", symbol = \"circle\", pgrid.draw = FALSE)"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"spatial-multivariate-analysis","dir":"Articles","previous_headings":"","what":"Spatial multivariate analysis","title":"Guerry data: Spatial Multivariate Analysis","text":"last decades, several approaches developed consider geographical multivariate information simultaneously. multivariate aspect usually treated techniques dimensionality reduction similar PCA. hand, several alternatives proposed integrate spatial information.","code":""},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"spatial-partition","dir":"Articles","previous_headings":"Spatial multivariate analysis","what":"Spatial partition","title":"Guerry data: Spatial Multivariate Analysis","text":"One alternative consider spatial partition study area. case, spatial information coded categorical variable, category corresponds region whole study area. instance, Guerry‚Äôs data contained partition France 5 regions. used -class analysis (BCA, Dol√©dec Chessel 1987), investigate differences regions. BCA maximizes variance groups. , 28.8 % total variance (sum eigenvalues PCA) corresponds -regions variance (sum eigenvalues BCA). main graphical outputs obtained generic plot function:  barplot eigenvalues indicates two axes interpreted. first two BCA dimensions account 59 % 30.2 %, respectively, -regions variance.  coefficients used construct linear combinations variables represented:  first axis opposed literacy property crime, suicides illegitimate births. second axis mainly aligned personal crime donations poor. Projections d√©partements BCA axes can represented factorial map:  scores can mapped show spatial aspects:  results close obtained PCA: first axis contrasted North East (la France √©clair√©e) regions South separated regions second axis. high variability region Centre also noticeable. contrast, South homogeneous.","code":"bet <- bca(pca, region.names, scannf = FALSE, nf = 2) bet$ratio #> [1] 0.288139 plot(bet) barplot(bet$eig) bet$eig/sum(bet$eig) * 100 #> [1] 58.995823 30.159802  7.417445  3.426930 s.arrow(bet$c1, plabel.cex = 0.8) s.label(bet$ls, as.character(dep.names), ppoint.cex = 0, plabel.optim = TRUE, plabel.col = col.region[region.names], plabel.cex = 0.5) s.class(bet$ls, fac = region.names, col = col.region, ellipse = 0, add = TRUE) s.value(xy, bet$ls, symbol = \"circle\", Sp = france.map, pSp.col = col.region[region.names], pSp.border = \"transparent\")"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"spatial-explanatory-variables","dir":"Articles","previous_headings":"Spatial multivariate analysis","what":"Spatial explanatory variables","title":"Guerry data: Spatial Multivariate Analysis","text":"Principal component analysis respect instrumental variables (PCAIV, Rao 1964), related methods, often used community ecology identify spatial relationships. spatial information introduced form spatial predictors analysis maximized ‚Äúspatial variance‚Äù (.e., variance explained spatial predictors). Note BCA can also considered particular case PCAIV, explanatory variables dummy variables indicating group membership.","code":""},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"trend-surface-of-geographic-coordinates","dir":"Articles","previous_headings":"Spatial multivariate analysis > Spatial explanatory variables","what":"Trend surface of geographic coordinates","title":"Guerry data: Spatial Multivariate Analysis","text":"Student (1914) proposed express observed values time series polynomial function time, mentioned done spatial data well. Borcard, Legendre, Drapeau (1992) extended approach spatial multivariate case introducing polynomial functions geographic coordinates predictors PCAIV. call approach PCAIV-POLY. centroids d√©partements France used construct second-degree orthogonal polynomial.  PCAIV performed using pcaiv function: , 32.4 % total variance (sum eigenvalues PCA) explained second-degree polynomial (sum eigenvalues PCAIV). first two dimensions account 51.4 % 35.2 %, respectively, explained variance. outputs PCAIV-POLY (coefficients variables, maps d√©partements scores, etc.) similar obtained BCA. can represented easily generic plot function:","code":"poly.xy <- orthobasis.poly(xy, degree = 2) s.value(xy, poly.xy, Sp = france.map, plegend.drawKey = FALSE) pcaiv.xy <- pcaiv(pca, poly.xy, scannf = FALSE, nf = 2) sum(pcaiv.xy$eig)/sum(pca$eig) * 100 #> [1] 32.36025 pcaiv.xy$eig/sum(pcaiv.xy$eig) * 100 #> [1] 51.423264 35.152362  5.954475  4.799075  2.670825 plot(pcaiv.xy)"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"morans-eigenvector-maps","dir":"Articles","previous_headings":"Spatial multivariate analysis > Spatial explanatory variables","what":"Moran‚Äôs eigenvector maps","title":"Guerry data: Spatial Multivariate Analysis","text":"alternative way build spatial predictors diagonalization spatial weighting matrix W. Moran‚Äôs eigenvector maps (MEM, Dray, Legendre, Peres-Neto 2006) n‚àí1n-1 eigenvectors doubly-centered matrix W. orthogonal vectors unit norm maximizing MC (Griffith 1996). MEM associated high positive (negative) eigenvalues high positive (negative) autocorrelation. MEM associated eigenvalues small absolute values correspond low spatial autocorrelation, suitable defining spatial structures. used spatial weighting matrix defined construct MEM. first ten MEM, corresponding highest levels spatial autocorrelation, mapped:  introduced first ten MEM spatial explanatory variables PCAIV. call approach PCAIV-MEM. , 44.1 % total variance (sum eigenvalues PCA) explained first ten MEM (sum eigenvalues PCAIV). first two dimensions account 54.9 % 26.3 %, respectively, explained variance. outputs PCAIV-MEM (coefficients variables, maps d√©partements scores, etc.) similar obtained BCA. can represented easily generic plot function:","code":"mem1 <- scores.listw(lw) s.value(xy, mem1[, 1:9], Sp = france.map, plegend.drawKey = FALSE) pcaiv.mem <- pcaiv(pca, mem1[,1:10], scannf = FALSE) sum(pcaiv.mem$eig)/sum(pca$eig) * 100 #> [1] 44.11597 pcaiv.mem$eig/sum(pcaiv.mem$eig) * 100 #> [1] 54.928640 26.300082  9.042300  4.574408  3.532962  1.621607 plot(pcaiv.mem)"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"spatial-graph-and-weighting-matrix","dir":"Articles","previous_headings":"Spatial multivariate analysis","what":"Spatial graph and weighting matrix","title":"Guerry data: Spatial Multivariate Analysis","text":"MEM framework introduced spatial information multivariate analysis eigendecomposition spatial weighting matrix. Usually, consider part information contained matrix subset MEM used regressors PCAIV. section, focus multivariate methods consider spatial weighting matrix original form. Wartenberg (1985) first develop multivariate analysis based MC. work considered normed centered variables (.e., normed PCA) multivariate part binary symmetric connectivity matrix spatial aspect. Dray, Sa√Ød, D√©bias (2008) generalized Wartenberg‚Äôs method introducing row-standardized spatial weighting matrix analysis statistical triplet. approach general allows us define spatially-constrained versions various methods (corresponding different triplets) correspondence analysis multiple correspondence analysis. MULTISPATI finds coefficients obtain linear combination variables maximizes compromise classical multivariate analysis generalized version Moran‚Äôs coefficient. main outputs MULTISPATI can represented easily generic plot function:  barplot eigenvalues suggests two main spatial structures. Eigenvalues MULTISPATI product variance spatial autocorrelation scores, PCA maximizes variance. differences two methods computed summary function: Hence, loss variance compared PCA (2.14 versus 2.017 axis 1; 1.201 versus 1.177 axis 2) gain spatial autocorrelation (0.551 versus 0.637 axis 1; 0.561 versus 0.59 axis 2). Coefficients variables allow interpret structures:  first axis opposes literacy property crime, suicides illegitimate births. second axis aligned mainly personal crime donations poor. maps scores show spatial structures close identified PCA. similarity results PCA spatially optimized version confirm main structures Guerry‚Äôs data spatial. Spatial autocorrelation can seen link one variable lagged vector. interpretation used construct Moran scatterplot can extended multivariate case MULTISPATI analyzing link scores lagged scores:  d√©partement can represented factorial map arrow (bottom corresponds score, head corresponds lagged score. short arrow reveals local spatial similarity (one plot neighbors) long arrow reveals spatial discrepancy. viewpoint can interpreted multivariate extension local index spatial association (Anselin 1995). instance: * Aude small arrow, indicating d√©partement similar neighbors. * Haute-Loire long horizontal arrow reflects high values variables Infants (31017), Suicides (163241) Crime_prop (18043) compared average values neighbors (27032.4, 60097.8 10540.8 three variables). * Finist√®re corresponds arrow long vertical length due high values compared neighbors Donations (23945 versus 12563) Crime_pers (29872 versus 25962). link scores lagged scores (averages neighbors weighted spatial connection matrix) can mapped geographical space. first two axes, :","code":"ms <- multispati(pca, lw, scannf = FALSE) plot(ms) summary(ms) #>  #> Multivariate Spatial Analysis #> Call: multispati(dudi = pca, listw = lw, scannf = FALSE) #>  #> Scores from the initial duality diagram: #>          var      cum     ratio     moran #> RS1 2.140470 2.140470 0.3567451 0.5506343 #> RS2 1.200820 3.341290 0.5568817 0.5614030 #> RS3 1.102047 4.443337 0.7405562 0.1805569 #>  #> Multispati eigenvalues decomposition: #>           eig      var     moran #> CS1 1.2858683 2.017171 0.6374612 #> CS2 0.6939887 1.176551 0.5898499 s.arrow(ms$c1, plabel.cex = 0.8) s.match(ms$li, ms$ls, plabel.cex = 0) s.match(ms$li[c(10, 41, 27), ], ms$ls[c(10, 41, 27), ], label = dep.names[c(10,       41, 27)], plabel.cex = 0.8, add = TRUE) s.value(xy, ms$li, Sp = france.map)"},{"path":"http://friendly.github.io/Guerry/articles/MultiSpat.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"Conclusions","title":"Guerry data: Spatial Multivariate Analysis","text":"Even methods presented quite different theoretical practical viewpoints, applications Guerry‚Äôs dataset yield similar results. provided quantitative measure similarity computing Procrustes statistics [Peres-Neto Jackson (2001);SD161] scores d√©partements onto first two axes different analyses. values statistic high significant; confirms high concordance outputs different methods.","code":"mat <- matrix(NA, 4, 4) mat.names <- c(\"PCA\", \"BCA\", \"PCAIV-POLY\", \"PCAIV-MEM\", \"MULTISPATI\") colnames(mat) <- mat.names[-5] rownames(mat) <- mat.names[-1]  mat[1, 1] <- procuste.randtest(pca$li[, 1:2], bet$ls[, 1:2])$obs mat[2, 1] <- procuste.randtest(pca$li[, 1:2], pcaiv.xy$ls[, 1:2])$obs mat[3, 1] <- procuste.randtest(pca$li[, 1:2], pcaiv.mem$ls[, 1:2])$obs mat[4, 1] <- procuste.randtest(pca$li[, 1:2], ms$li[, 1:2])$obs mat[2, 2] <- procuste.randtest(bet$ls[, 1:2], pcaiv.xy$ls[, 1:2])$obs mat[3, 2] <- procuste.randtest(bet$ls[, 1:2], pcaiv.mem$ls[, 1:2])$obs mat[4, 2] <- procuste.randtest(bet$ls[, 1:2], ms$li[, 1:2])$obs mat[3, 3] <- procuste.randtest(pcaiv.xy$ls[, 1:2], pcaiv.mem$ls[, 1:2])$obs mat[4, 3] <- procuste.randtest(pcaiv.xy$ls[, 1:2], ms$li[, 1:2])$obs mat[4, 4] <- procuste.randtest(pcaiv.mem$ls[, 1:2], ms$li[, 1:2])$obs  mat #>                  PCA       BCA PCAIV-POLY PCAIV-MEM #> BCA        0.9788594        NA         NA        NA #> PCAIV-POLY 0.9791939 0.9897463         NA        NA #> PCAIV-MEM  0.9885944 0.9936217  0.9954116        NA #> MULTISPATI 0.9868799 0.9954034  0.9951133 0.9986471"},{"path":[]},{"path":"http://friendly.github.io/Guerry/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Friendly. Author, maintainer. Stephane Dray. Author. Roger Bivand. Contributor.","code":""},{"path":"http://friendly.github.io/Guerry/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Friendly M, Dray S (2024). Guerry: Maps, Data Methods Related Guerry (1833) \"Moral Statistics France\". R package version 1.8.3, https://github.com/friendly/Guerry.","code":"@Manual{,   title = {Guerry: Maps, Data and Methods Related to Guerry (1833) \"Moral Statistics of France\"},   author = {Michael Friendly and Stephane Dray},   year = {2024},   note = {R package version 1.8.3},   url = {https://github.com/friendly/Guerry}, }"},{"path":"http://friendly.github.io/Guerry/index.html","id":"guerry-","dir":"","previous_headings":"","what":"Maps, Data and Methods Related to Guerry (1833) ","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Version: 1.8.3 Guerry package comprises maps France 1830, multivariate data .-M. Guerry others, statistical graphic methods related Guerry‚Äôs Moral Statistics France. goal facilitate exploration development statistical graphic methods multivariate data geo-spatial context historical interest. package stems Friendly (2007). history Andr√©-Michel Guerry work, see Friendly (2022), Life Work Andr√©-Michel Guerry, Revisited. figure shows reproduction six choropleth maps Guerry used discuss relations among main ‚Äúmoral variables‚Äù. scaled better. Guerry asked, patterns reflect simply individual behavior, laws discovered data?","code":""},{"path":"http://friendly.github.io/Guerry/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"can install Guerry CRAN development version follows:","code":""},{"path":"http://friendly.github.io/Guerry/index.html","id":"data-sets","dir":"","previous_headings":"","what":"Data sets","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Guerry package contains following data sets:","code":""},{"path":[]},{"path":"http://friendly.github.io/Guerry/index.html","id":"maps","dir":"","previous_headings":"Examples","what":"Maps","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Guerry‚Äôs time, map France data contained 86 departments. two base maps package gfrance gfrance85. differ Corsica, outside continental boundaries, excluded later. two datasets SpatialPolygonsDataFrames constructed sp package. means contain S4 components S4 methods gfrance@polygons polygon boundaries 1830 map France gfrance@data equivalent variables contained Guerry data set Thus, can can just use plot(gfrance) plot outlines departments,  spplot method produces choropleth map, shaded given variable gfrance@data  can plot maps several variables together simply listing names vector.  ‚Äôs problem . spplot assumes variables scale comparative plots, best transform variables ranks (Guerry ). well, use something like Guerry‚Äôs pallet, dark = Worse.  purposes, might want produce map, shaded Region adding labels names departments. illustrated using gfrance85 map (excluding Corsica), coordinates() gets (X, Y) coordinates centroids department, text() sp object plots labels.","code":"data(gfrance) names(gfrance)  # list the @data variables #>  [1] \"CODE_DEPT\"       \"COUNT\"           \"AVE_ID_GEO\"      \"dept\"            #>  [5] \"Region\"          \"Department\"      \"Crime_pers\"      \"Crime_prop\"      #>  [9] \"Literacy\"        \"Donations\"       \"Infants\"         \"Suicides\"        #> [13] \"MainCity\"        \"Wealth\"          \"Commerce\"        \"Clergy\"          #> [17] \"Crime_parents\"   \"Infanticide\"     \"Donation_clergy\" \"Lottery\"         #> [21] \"Desertion\"       \"Instruction\"     \"Prostitutes\"     \"Distance\"        #> [25] \"Area\"            \"Pop1831\" library(sp) plot(gfrance) spplot(gfrance, \"Crime_pers\") # plot several together spplot(gfrance, c(\"Crime_pers\", \"Crime_prop\", \"Literacy\" ),         layout=c(3,1), main=\"Guerry's moral variables\") gfrance$Crime_pers <- rank(gfrance$Crime_pers) gfrance$Crime_prop <- rank(gfrance$Crime_prop) gfrance$Literacy   <- rank(gfrance$Literacy)  my.palette <- rev(RColorBrewer::brewer.pal(n = 9, name = \"PuBu\")) spplot(gfrance, c(\"Crime_pers\", \"Crime_prop\", \"Literacy\" ),         names.attr = c(\"Personal crime\", \"Property crime\", \"Literacy\"),        col.regions = my.palette, cuts = 8,        layout=c(3,1), as.table=TRUE, main=\"Guerry's moral variables\") data(gfrance85) # extract region and dept names & assign colors xy            <- coordinates(gfrance85)            # department centroids dep.names     <- data.frame(gfrance85)[,6] region.names  <- data.frame(gfrance85)[,5] col.region    <- colors()[c(149,254,468,552,26)]   # assign colors  plot(gfrance85, col=col.region[region.names]) text(xy, labels=dep.names, cex=0.5)"},{"path":"http://friendly.github.io/Guerry/index.html","id":"plots","dir":"","previous_headings":"Examples","what":"Plots","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Guerry interested determining whether occurrence crimes related literacy ‚Äúmoral variables‚Äù. idea correlation invented, aware idea scatterplot. Plotting crimes persons vs.¬†Literacy (‚Äú% can read & write‚Äù). base R version, might want code point symbols colors regions France.  Now try data ellipse, regression line. version also uses loess smooth labels 8 outlying departments.","code":"data(Guerry)  plot(Crime_pers ~ Literacy, data=Guerry,     col=Region,      pch=(15:19)[Region],     ylab = \"Pop. per crime against persons\",     xlab = \"Percent who can read & write\"     )  legend(x=\"bottomright\",      legend = c(\"Center\", \"East\", \"North\", \"South\", \"West\"),      pch = 15:19,     col = as.factor(levels(Guerry$Region))) library(car) with(Guerry,{   dataEllipse(Literacy, Crime_pers,       levels = 0.68,       ylim = c(0,40000), xlim = c(0, 80),       ylab=\"Pop. per crime against persons\",       xlab=\"Percent who can read & write\",       pch = 16,       grid = FALSE,       id = list(method=\"mahal\",                  n = 8, labels=Department, location=\"avoid\", cex=1.2),       center.pch = 3, center.cex=5,       cex.lab=1.5)          dataEllipse(Literacy, Crime_pers,       levels = 0.95, add=TRUE,       ylim = c(0,40000), xlim = c(0, 80),       lwd=2, lty=\"longdash\",       col=\"gray\",       center.pch = FALSE       )    abline( lm(Crime_pers ~ Literacy), lwd=2)    lines(loess.smooth(Literacy, Crime_pers), col=\"red\", lwd=3)   }     )"},{"path":"http://friendly.github.io/Guerry/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"vignette, Guerry data: Spatial Multivariate Analysis, written St√©phane Dray uses packages ade4 adegraphics illustrate methods spatial multivariate data focus either multivariate aspect spatial one, well modern methods integrate simultaneously. new vignette, Guerry data: Multivariate Analysis, uses Guerry‚Äôs data illustrate graphical methods multivariate visualization. See:","code":"vignette(\"MultiSpat\", package=\"Guerry\") vignette(\"guerry-multivariate\", package=\"Guerry\")"},{"path":"http://friendly.github.io/Guerry/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"","code":"To cite package ‚ÄòGuerry‚Äô in publications use:    Friendly M, Dray S (2021). _Guerry: Maps, Data and Methods Related to Guerry (1833) \"Moral Statistics   of France\"_. R package version 1.7.4, <https://CRAN.R-project.org/package=Guerry>.  A BibTeX entry for LaTeX users is    @Manual{,     title = {Guerry: Maps, Data and Methods Related to Guerry (1833) \"Moral Statistics of France\"},     author = {Michael Friendly and St√©phane Dray},     year = {2021},     note = {R package version 1.7.4},     url = {https://CRAN.R-project.org/package=Guerry},   }"},{"path":"http://friendly.github.io/Guerry/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Angeville, . d‚Äô (1836). Essai sur la Statistique de la Population francaise, Paris: F. Darfour. Friendly, M. (2007). .-M. Guerry‚Äôs Moral Statistics France: Challenges Multivariable Spatial Analysis. Statistical Science, 22, 368-399. https://www.datavis.ca/papers/guerry-STS241.pdf Friendly, M. (2007). Supplementary materials Andre-Michel Guerry‚Äôs Moral Statistics France: Challenges Multivariate Spatial Analysis, https://www.datavis.ca/gallery/guerry/. Friendly, M. (2022). Life Work Andr√©-Michel Guerry, Revisited. Sociological Spectrum, 42 (1). https://www.tandfonline.com/doi/full/10.1080/02732173.2022.2078450. eprint","code":""},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"Adolph d'Angeville (1836) presented comprehensive statistical summary nearly every known measurable characteristic French population (department) Essai sur la Statistique de la Population francaise. Using graphic method shaded (choropleth) maps invented Baron Charles Dupin applied significant social questions Guerry, Angeville's Essai became first broad general application principles graphic representation national industrial population data. collection variables data frame Angeville small subset 120 columns presented 8 tables many graphic maps.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"","code":"data(Angeville)"},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"data frame 86 observations following 16 variables. dept numeric vector Department Department name: factor levels Ain Aisne ... Vosges Yonne Mortality Mortality: Number births give 100 people age 21 (T1:13) Marriages Number marriages per 1000 men aged 21 (T1:15) Legit_births Annual . legitimate births (T2:17) Illeg_births Annual . illegitimate births (T2:18) Recruits Number people registered military recruitment 1825-1833 (T3:32) Conscripts Number inhabitants per military conscript (T3:33) Exemptions Number military exemptions per 1000 physical causes (T3:47) Farmers Number farmers census 1831 (T4:65) Recruits_ignorant Average number ignorant recruits per 1000 (T5:69) Schoolchildren Number schoolchildren per 1000 inhabitants (T5:71) Windows_doors Number windows & doors houses per 100 inhabitants (T5:72).     sometimes taken indicator household wealth. Primary_schools \"Number primary schools (T5:74) Life_exp Life expectancy years (T1:9a,9b) Pop1831 Population 1831","code":""},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"ID codes dept modified Angeville's tables match used Guerry. Angeville's variables recorded variety different ways calculated columns tables included .  well, variable names labels used often shortened complete descriptions given d'Angeville. notation \"(Tn:k)\" indicates variable used came Table n, Column k.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"Angeville, . d' (1836). Essai sur la Statistique de la Population francaise, Paris: F. Darfour. data digitally scanned Angeville's tables using OCR software, extensively edited correct obvious errors finally subjected consistency checks using column totals ranked values provided.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"Whitt, H. P. (2007). Modernism, internal colonialism, direction violence: suicide crimes persons France, 1825-1830.  Unpublished ms.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Angeville.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Data from d'Angeville (1836) on the population of France ‚Äî Angeville","text":"","code":"library(Guerry) library(sp) library(RColorBrewer)  data(Guerry) data(gfrance) data(Angeville)  gf <- gfrance     # the SpatialPolygonsDataFrame  # Add some Angeville variables, transform them to ranks gf$Mortality       <- rank(Angeville$Mortality) gf$Marriages       <- rank(Angeville$Marriages) gf$Legit_births    <- rank(Angeville$Legit_births) gf$Illeg_births    <- rank(Angeville$Illeg_births) gf$Farmers         <- rank(Angeville$Farmers) gf$Schoolchildren  <- rank(Angeville$Schoolchildren)  # plot them on map of France my.palette <- rev(brewer.pal(n = 9, name = \"PuBu\")) spplot(gf,         c(\"Mortality\", \"Marriages\", \"Legit_births\",  \"Illeg_births\", \"Farmers\", \"Schoolchildren\"),        names.attr = c(\"Mortality\", \"Marriages\", \"Legit_births\",                         \"Illeg_births\", \"Farmers\", \"Schoolchildren\"),        layout=c(3,2),         as.table=TRUE,         col.regions = my.palette,         cuts = 8, # col = \"transparent\",        main=\"Angeville variables\")"},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":null,"dir":"Reference","previous_headings":"","what":"Map of France in 1830 with the Guerry data ‚Äî gfrance","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"gfrance SpatialPolygonsDataFrame object created sp package, containing polygon boundaries map France 1830, together Guerry data frame.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"","code":"data(gfrance)"},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"format : Formal class 'SpatialPolygonsDataFrame' [package \"sp\"] 5 slots: gfrance@data, gfrance@polygons, gfrance@plotOrder, gfrance@bbox, gfrance@proj4string. See: SpatialPolygonsDataFrame descriptions components. analysis variables, represented gfrance@data  described  Guerry.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"present version, PROJ4 projection specified.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"Friendly, M. (2007). Supplementary materials Andre-Michel Guerry's Moral Statistics France: Challenges Multivariate Spatial Analysis, http://www.datavis.ca/gallery/guerry/.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"Friendly, M. (2007). .-M. Guerry's Moral Statistics France: Challenges Multivariable Spatial Analysis.  Statistical Science, 22, 368-399.","code":""},{"path":[]},{"path":"http://friendly.github.io/Guerry/reference/gfrance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map of France in 1830 with the Guerry data ‚Äî gfrance","text":"","code":"library(sp) data(gfrance) names(gfrance)  ## list @data variables #>  [1] \"CODE_DEPT\"       \"COUNT\"           \"AVE_ID_GEO\"      \"dept\"            #>  [5] \"Region\"          \"Department\"      \"Crime_pers\"      \"Crime_prop\"      #>  [9] \"Literacy\"        \"Donations\"       \"Infants\"         \"Suicides\"        #> [13] \"MainCity\"        \"Wealth\"          \"Commerce\"        \"Clergy\"          #> [17] \"Crime_parents\"   \"Infanticide\"     \"Donation_clergy\" \"Lottery\"         #> [21] \"Desertion\"       \"Instruction\"     \"Prostitutes\"     \"Distance\"        #> [25] \"Area\"            \"Pop1831\"         plot(gfrance)   ## just show the map outline   # Show basic choropleth plots of some of the variables spplot(gfrance, \"Crime_pers\")   # use something like Guerry's pallete, where dark = Worse my.palette <- rev(RColorBrewer::brewer.pal(n = 9, name = \"PuBu\")) spplot(gfrance, \"Crime_pers\", col.regions = my.palette, cuts = 8)    spplot(gfrance, \"Crime_prop\")   # Note that spplot assumes all variables are on the same scale for comparative plots # transform variables to ranks (as Guerry did)   if (FALSE) { # \\dontrun{ local({   gfrance$Crime_pers <- rank(gfrance$Crime_pers)   gfrance$Crime_prop <- rank(gfrance$Crime_prop)   gfrance$Literacy <- rank(gfrance$Literacy)   gfrance$Donations <- rank(gfrance$Donations)   gfrance$Infants <- rank(gfrance$Infants)   gfrance$Suicides <- rank(gfrance$Suicides)         spplot(gfrance, c(\"Crime_pers\", \"Crime_prop\", \"Literacy\", \"Donations\", \"Infants\", \"Suicides\"),      layout=c(3,2), as.table=TRUE, main=\"Guerry's main moral variables\") })  } # }"},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":null,"dir":"Reference","previous_headings":"","what":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"gfrance85 SpatialPolygonsDataFrame object created sp package, containing polygon boundaries map France 1830, together Guerry data frame.  version excludes Corsica, outlier map many analyses.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"","code":"data(gfrance85)"},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"format : Formal class 'SpatialPolygonsDataFrame' [package \"sp\"] 5 slots: gfrance85@data, gfrance85@polygons, gfrance85@plotOrder, gfrance85@bbox, gfrance85@proj4string. See: SpatialPolygonsDataFrame descriptions components. analysis variables  described  Guerry.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"present version, PROJ4 projection specified.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"Friendly, M. (2007). Supplementary materials Andr?-Michel Guerry's Moral Statistics France: Challenges Multivariate Spatial Analysis, http://datavis.ca/gallery/guerry/.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"Dray, S. Jombart, T. (2009). Revisit Guerry's Data: Introducing Spatial Constraints Multivariate Analysis. Unpublished manuscript. Friendly, M. (2007). .-M. Guerry's Moral Statistics France: Challenges Multivariable Spatial Analysis.  Statistical Science, 22, 368-399.","code":""},{"path":"http://friendly.github.io/Guerry/reference/gfrance85.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map of France in 1830 with the Guerry data, excluding Corsica ‚Äî gfrance85","text":"","code":"data(gfrance85) require(sp) require(scales) #> Loading required package: scales plot(gfrance85)   # plot the empty outline map   # extract some useful components df <- data.frame(gfrance85)[,7:12]       # main moral variables xy <- coordinates(gfrance85)             # department centroids dep.names <- data.frame(gfrance85)[,6] region.names <- data.frame(gfrance85)[,5] col.region <- colors()[c(149,254,468,552,26)] |>   scales::alpha(alpha = 0.2)   # plot the map showing regions by color with department labels op <-par(mar=rep(0.1,4)) plot(gfrance85,col=col.region[region.names]) text(xy, labels=dep.names, cex=0.6)  par(op)"},{"path":"http://friendly.github.io/Guerry/reference/Guerry-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Maps, Data and Methods Related to Guerry (1833) ","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Andre-Michel Guerry (1833) first systematically collect analyze social data things crime, literacy suicide view determining social laws relations among variables. provided first essentially multivariate georeferenced spatial data socially important questions, e.g., rate crime related education literacy?  vary departments France? rates crime suicide within departments stable time? age well idea correlation invented, Guerry used graphics statistical maps try shed light questions. later work (Guerry, 1864), explicitly tried entertain larger questions, still-limited statistical tools:  Can rates various crimes related multiple causes predictors? rates ascribable causes France similar different found England? Guerry package comprises maps France 1830, multivariate data .-M. Guerry others (Angeville, 1836), statistical graphic methods related Guerry's Moral Statistics France. goal providing R package facilitate exploration development statistical graphic methods multivariate data geo-spatial context.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"DESCRIPTION file: package yet installed build time.   Index:  package yet installed build time. Data Guerry others contained data frame Guerry. Corsica often considered outlier spatially statistically, map France circa 1830, together Guerry data provided SpatialPolygonsDataFrames two forms: gfrance 86 departments, gfrance85, 85 departments excluding Corsica.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"Michael Friendly [aut, cre] (<https://orcid.org/0000-0002-3237-0941>),   Stephane Dray [aut] (<https://orcid.org/0000-0003-0153-1105>),   Roger Bivand [ctb] Maintainer: Michael Friendly <friendly@yorku.ca>","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maps, Data and Methods Related to Guerry (1833) ","text":"d'Angeville, .  (1836). Essai sur la Statistique de la Population francaise, Paris: F. Darfour. Dray, S. Jombart, T. (2011). Revisit Guerry's Data: Introducing Spatial Constraints Multivariate Analysis. Annals Applied Statistics, 5(4). Brunsdon, C. Dykes, J. (2007). Geographically weighted visualization: interactive graphics scale-varying exploratory analysis. Geographical Information Science Research Conference (GISRUK 2007). NUI Maynooth, Ireland, April, 2007. https://www.maynoothuniversity.ie/national-centre-geocomputation-ncg. Friendly, M. (2007). .-M. Guerry's Moral Statistics France: Challenges Multivariable Spatial Analysis.  Statistical Science, 22, 368-399.  http://www.datavis.ca/papers/guerry-STS241.pdf Friendly, M. (2007). Supplementary materials Andre-Michel Guerry's Moral Statistics France: Challenges Multivariate Spatial Analysis, http://www.datavis.ca/gallery/guerry/. Friendly, M. (2022). life works Andre-Michel Guerry, revisited. Sociological Spectrum, 42, 233‚Äì259. doi:10.1080/02732173.2022.2078450 Guerry, .-M. (1833). Essai sur la statistique morale de la France Paris: Crochard. English translation: Hugh P. Whitt Victor W. Reinking, Lewiston, N.Y.: Edwin Mellen Press, 2002. Guerry, .-M. (1864). Statistique morale de l'Angleterre compar?e avec la statistique morale de la France, d'apres les comptes de l'administration de la justice criminelle en Angleterre et en France, etc. Paris: J.-B. Bailliere et fils.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from A.-M. Guerry, ","title":"Data from A.-M. Guerry, ","text":"Andre-Michel Guerry (1833) first systematically collect analyze social data things crime, literacy suicide view determining social laws relations among variables. Guerry data frame comprises collection 'moral variables' 86 departments France around 1830.  additional variables added sources.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from A.-M. Guerry, ","text":"","code":"data(Guerry)"},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from A.-M. Guerry, ","text":"data frame 86 observations (departments France) following 23 variables. dept Department ID: Standard numbers departments, except Corsica (200) Region Region France ('N'='North', 'S'='South', 'E'='East', 'W'='West', 'C'='Central'). Corsica coded NA Department Department name: Departments named according usage 1830, without accents.     \tfactor levels Ain Aisne Allier ... Vosges Yonne Crime_pers Population per Crime persons. Source: A2 (Comptes general, 1825-1830) Crime_prop Population per Crime property. Source: A2 (Compte general, 1825-1830) Literacy Percent Read & Write: Percent military conscripts can read write. Source: A2 Donations Donations poor. Source: A2 (Bulletin des lois) Infants Population per illegitimate birth. Source: A2 (Bureau des Longitudes, 1817-1821) Suicides Population per suicide. Source: A2 (Compte general, 1827-1830) MainCity Size principal city ('1:Sm', '2:Med', '3:Lg'), used surrogate population density. Large refers top 10, small bottom 10; rest classed Medium. Source: A1. ordered factor levels 1:Sm < 2:Med < 3:Lg Wealth Per capita tax personal property. ranked index based taxes personal movable property per inhabitant. Source: A1 Commerce Commerce Industry, measured rank number patents / population. Source: A1 Clergy Distribution clergy, measured rank number Catholic priests active service / population. Source: A1 (Almanach officiel du clergy, 1829) Crime_parents Crimes parents, measured rank ratio crimes parents crimes‚Äì Average years 1825-1830. Source: A1 (Compte general) Infanticide Infanticides per capita. ranked ratio number infanticides population‚Äì Average years 1825-1830. Source: A1 (Compte general) Donation_clergy Donations clergy. ranked ratio number bequests donations inter vivios population‚Äì Average years 1815-1824. Source: A1 (Bull. des lois, ordunn. d'autorisation) Lottery Per capita wager Royal Lottery. Ranked ratio proceeds bet royal lottery population‚Äî Average years 1822-1826. Source: A1 (Compte rendus par le ministre des finances) Desertion Military desertion, ratio number young soldiers accused desertion force military contingent, minus deficit produced insufficiency available billets‚Äì Average years 1825-1827. Source: A1 (Compte du ministere du guerre, 1829 etat V) Instruction Instruction. Ranks recorded Guerry's map Instruction. Note: inversely related Literacy (defined ) Prostitutes Prostitutes Paris. Number prostitutes registered Paris 1816 1834, classified department birth Source: Parent-Duchatelet (1836), De la prostitution en Paris Distance Distance Paris (km). Distance department centroid centroid Seine (Paris) Source: calculated department centroids Area Area (1000 km^2). Source: Angeville (1836) Pop1831 1831 population. Population 1831, taken Angeville (1836), Essai sur la Statistique de la Population francaise, 1000s","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data from A.-M. Guerry, ","text":"Note variables (e.g., Crime_pers) scaled 'better' morally. Values quantitative variables displayed Guerry's maps taken Table A2 English translation Guerry (1833) Whitt Reinking. Values ranked variables taken Table A1, corrections applied. maximum indicated rank 1, minimum rank 86.","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data from A.-M. Guerry, ","text":"Angeville, . (1836). Essai sur la Statistique de la Population fran?aise Paris: F. Doufour. Guerry, .-M. (1833). Essai sur la statistique morale de la France Paris: Crochard. English translation: Hugh P. Whitt Victor W. Reinking, Lewiston, N.Y. : Edwin Mellen Press, 2002. Parent-Duchatelet, . (1836). De la prostitution dans la ville de Paris, 3rd ed, 1857,  p. 32, 36","code":""},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from A.-M. Guerry, ","text":"Dray, S., & Jombart, T. (2011). Revisiting Guerry's data: Introducing spatial constraints multivariate analysis. Annals Applied Statistics, 5, 2278-2299 Brunsdon, C. Dykes, J. (2007). Geographically weighted visualization: Interactive graphics scale-varying exploratory analysis. Geographical Information Science Research Conference (GISRUK 07), NUI Maynooth, Ireland, April, 2007. Friendly, M. (2007). .-M. Guerry's Moral Statistics France: Challenges Multivariable Spatial Analysis.  Statistical Science, 22, 368-399. Friendly, M. (2007). Data .-M. Guerry, Essay Moral Statistics France (1833),  https://www.datavis.ca/gallery/guerry/guerrydat.html.","code":""},{"path":[]},{"path":"http://friendly.github.io/Guerry/reference/Guerry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Data from A.-M. Guerry, ","text":"","code":"library(car) #> Loading required package: carData data(Guerry)  # Is there a relation between crime and literacy?  # Plot personal crime rate vs. literacy, using data ellipses.  #    Identify the departments that stand out set.seed(12315) with(Guerry,{   dataEllipse(Literacy, Crime_pers,     levels = 0.68,     ylim = c(0,40000), xlim = c(0, 80),     ylab=\"Pop. per crime against persons\",     xlab=\"Percent who can read & write\",     pch = 16,     grid = FALSE,     id = list(method=\"mahal\", n = 8, labels=Department, location=\"avoid\", cex=1.2),     center.pch = 3, center.cex=5,     cex.lab=1.5)   # add a 95% ellipse   dataEllipse(Literacy, Crime_pers,     levels = 0.95, add=TRUE,     ylim = c(0,40000), xlim = c(0, 80),     lwd=2, lty=\"longdash\",     col=\"gray\",     center.pch = FALSE     )      # add the LS line and a loess smooth.   abline( lm(Crime_pers ~ Literacy), lwd=2)     lines(loess.smooth(Literacy, Crime_pers), col=\"red\", lwd=3)   }     )   # A corrgram to show the relations among the main moral variables # Re-arrange variables by PCA ordering.  library(corrgram) corrgram(Guerry[,4:9], upper=panel.ellipse, order=TRUE)"},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution of crimes against persons at different ages ‚Äî propensity","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"dataset comes Plate IV, \"Influence de l'age\" Guerry(1833), transcribed Whitt & Reinking's (2002) translation Table 9A, pp. 38-43. gives rank ordering crimes persons seven age groups, long form.","code":""},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"","code":"data(\"propensity\")"},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"data frame 124 observations following 4 variables. age character vector, 7 age groups, <21, 21-30, 30-40 ... 60-70, 70- rank numeric vector, rank crime within age group crime character vector, label crime share numeric vector, share (frequency) crime population 1000","code":""},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"age group (males females), 17 frequent crimes listed rank order, followed 'crime' category.","code":""},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"H. P. Whitt V. W. Reinking (2002). Translation Andr\\'e-Michel Guerry's Essay Moral Statistics France, Lewiston, N.Y.: Edwin Mellen Press, 2002.","code":""},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"Guerry, .-M. (1833). Essai sur la statistique morale de la France Paris: Crochard.","code":""},{"path":"http://friendly.github.io/Guerry/reference/propensity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distribution of crimes against persons at different ages ‚Äî propensity","text":"","code":"data(propensity) ## maybe str(propensity) ; plot(propensity) ..."},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-183-2023-10-13","dir":"Changelog","previous_headings":"","what":"Version 1.8.3 (2023-10-13)","title":"Version 1.8.3 (2023-10-13)","text":"CRAN release: 2023-10-24 problem adegraphics package becoming archived triggered warning Guerry threatening fate. reply time, Guerry archived. re-submission fixes issues found win-builder. Moved examples demo/ Edit example gfrance85.Rd Restore use adegraphics vignette MultiSpat.Rmd demo/guerry_ggradar.R used non-CRAN package; package removed Suggests: example moved examples/.","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-182-2023-05-10","dir":"Changelog","previous_headings":"","what":"Version 1.8.2 (2023-05-10)","title":"Version 1.8.2 (2023-05-10)","text":"Incorporate parallel coord plots radar charts vignette","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-181-2023-05-05","dir":"Changelog","previous_headings":"","what":"Version 1.8.1 (2023-05-05)","title":"Version 1.8.1 (2023-05-05)","text":"CRAN release: 2023-05-05 largely maintenance release correct problem latin1 encoding used DESCRIPTION man/ files. non-ascii characters removed. Add reference Friendly (2022) Moved number examples/ demo/","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-180-2022-10-04","dir":"Changelog","previous_headings":"","what":"Version 1.8.0 (2022-10-04)","title":"Version 1.8.0 (2022-10-04)","text":"CRAN release: 2022-10-08 Fixed problems related retirement maptools #4, deleting Suggests: maptools Added new vignette, guerry-multivariate, illustrating multivariate methods Extensively revised README give better sense package datasets plots.","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-174","dir":"Changelog","previous_headings":"","what":"Version 1.7.4","title":"Version 1.7.4","text":"CRAN release: 2021-09-29 Restore MultiSpat vignette","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-173","dir":"Changelog","previous_headings":"","what":"Version 1.7.3","title":"Version 1.7.3","text":"begin guerry-multivariate vignette Fixed problem arising new spdep rgeos installed [thx: Roger Bivand]","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-171","dir":"Changelog","previous_headings":"","what":"Version 1.7.1","title":"Version 1.7.1","text":"CRAN release: 2021-07-29 translate/update/restore main vignette, MultiSpat.html Stephane Drey","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-170","dir":"Changelog","previous_headings":"","what":"Version 1.7.0","title":"Version 1.7.0","text":"CRAN release: 2020-01-29 Update links Guerry supplementary stuff resolve CRAN nits move sp Imports: resolve CRAN nits Removed Suggests: shapefiles added hexsticker README.md","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-16-2","dir":"Changelog","previous_headings":"","what":"Version 1.6-2","title":"Version 1.6-2","text":"Package development moved R-forge github, https://github.com/friendly/Guerry Updated Guerry-package.Rd utils::promptPackage()","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-16-2014-09-23","dir":"Changelog","previous_headings":"","what":"Version 1.6 (2014-09-23)","title":"Version 1.6 (2014-09-23)","text":"Removed MultiSpat vignette longer compatible CRAN policies. old PDF version made available R-Forge project page. Removed Suggests: spacemakeR (CRAN); moved sp, shapefiles Suggests: Removed thinSpatialPoly, now provided maptools Made examples gfrance.Rd  reduce check time","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-15-2011-11-08","dir":"Changelog","previous_headings":"","what":"Version 1.5 (2011-11-08)","title":"Version 1.5 (2011-11-08)","text":"Added back MultiSpat.Rnw vignette MultiSpat.tex disguised MultiSpat.Rnw Added NAMESPACE R 2.14+","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-14-2010-02-15","dir":"Changelog","previous_headings":"","what":"Version 1.4 (2010-02-15)","title":"Version 1.4 (2010-02-15)","text":"CRAN release: 2010-02-16 Remove temporarily MultiSpat.Rnw vignette","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-13-2009-11-19","dir":"Changelog","previous_headings":"","what":"Version 1.3 (2009-11-19)","title":"Version 1.3 (2009-11-19)","text":"CRAN release: 2009-12-03 Added thinnedSpatialPoly calculate thinned maps Added MultiSpat.Rnw vignette","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-12-2009-11-12","dir":"Changelog","previous_headings":"","what":"Version 1.2 (2009-11-12)","title":"Version 1.2 (2009-11-12)","text":"Added MultiSpat.pdf vignette (without .Rnw)","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-11-2009-10-28","dir":"Changelog","previous_headings":"","what":"Version 1.1 (2009-10-28)","title":"Version 1.1 (2009-10-28)","text":"CRAN release: 2009-10-30 Added Angeville data Released CRAN","code":""},{"path":"http://friendly.github.io/Guerry/news/index.html","id":"version-10-2009-10-20","dir":"Changelog","previous_headings":"","what":"Version 1.0 (2009-10-20)","title":"Version 1.0 (2009-10-20)","text":"Initial version uploaded R-Forge","code":""}]
